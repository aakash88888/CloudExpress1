(function (g, f) {
    if ("object" == typeof exports && "object" == typeof module) {
      module.exports = f();
    } else if ("function" == typeof define && define.amd) {
      define("rrwebSnapshot", [], f);
    } else if ("object" == typeof exports) {
      exports["rrwebSnapshot"] = f();
    } else {
      g["rrwebSnapshot"] = f();
    }
  }(this, () => {
var exports = {};
var module = { exports };
"use strict";var $e=Object.defineProperty,Pe=(e,t,r)=>t in e?$e(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,U=(e,t,r)=>Pe(e,typeof t!="symbol"?t+"":t,r);Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});var g=(e=>(e[e.Document=0]="Document",e[e.DocumentType=1]="DocumentType",e[e.Element=2]="Element",e[e.Text=3]="Text",e[e.CDATA=4]="CDATA",e[e.Comment=5]="Comment",e))(g||{});function Q(e){return e.nodeType===e.ELEMENT_NODE}function pe(e){const t=e==null?void 0:e.host;return(t==null?void 0:t.shadowRoot)===e}function J(e){return Object.prototype.toString.call(e)==="[object ShadowRoot]"}function We(e){return e.includes(" background-clip: text;")&&!e.includes(" -webkit-background-clip: text;")&&(e=e.replace(/\sbackground-clip:\s*text;/g," -webkit-background-clip: text; background-clip: text;")),e}function me(e){const{cssText:t}=e;if(t.split('"').length<3)return t;const r=["@import",`url(${JSON.stringify(e.href)})`];return e.layerName===""?r.push("layer"):e.layerName&&r.push(`layer(${e.layerName})`),e.supportsText&&r.push(`supports(${e.supportsText})`),e.media.length&&r.push(e.media.mediaText),r.join(" ")+";"}function q(e){try{const t=e.rules||e.cssRules;return t?We(Array.from(t,he).join("")):null}catch(t){return null}}function he(e){let t;if(ye(e))try{t=q(e.styleSheet)||me(e)}catch(r){}else if(be(e)&&e.selectorText.includes(":"))return ge(e.cssText);return t||e.cssText}function ge(e){const t=/(\[(?:[\w-]+)[^\\])(:(?:[\w-]+)\])/gm;return e.replace(t,"$1\\$2")}function ye(e){return"styleSheet"in e}function be(e){return"selectorText"in e}class Z{constructor(){U(this,"idNodeMap",new Map),U(this,"nodeMetaMap",new WeakMap)}getId(t){var r;if(!t)return-1;const i=(r=this.getMeta(t))==null?void 0:r.id;return i!=null?i:-1}getNode(t){return this.idNodeMap.get(t)||null}getIds(){return Array.from(this.idNodeMap.keys())}getMeta(t){return this.nodeMetaMap.get(t)||null}removeNodeFromMap(t){const r=this.getId(t);this.idNodeMap.delete(r),t.childNodes&&t.childNodes.forEach(i=>this.removeNodeFromMap(i))}has(t){return this.idNodeMap.has(t)}hasNode(t){return this.nodeMetaMap.has(t)}add(t,r){const i=r.id;this.idNodeMap.set(i,t),this.nodeMetaMap.set(t,r)}replace(t,r){const i=this.getNode(t);if(i){const l=this.nodeMetaMap.get(i);l&&this.nodeMetaMap.set(r,l)}this.idNodeMap.set(t,r)}reset(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}}function Fe(){return new Z}function we({element:e,maskInputOptions:t,tagName:r,type:i,value:l,maskInputFn:a}){let f=l||"";const o=i&&Y(i);return(t[r.toLowerCase()]||o&&t[o])&&(a?f=a(f,e):f="*".repeat(f.length)),f}function Y(e){return e.toLowerCase()}const ae="__rrweb_original__";function Se(e){const t=e.getContext("2d");if(!t)return!0;const r=50;for(let i=0;i<e.width;i+=r)for(let l=0;l<e.height;l+=r){const a=t.getImageData,f=ae in a?a[ae]:a;if(new Uint32Array(f.call(t,i,l,Math.min(r,e.width-i),Math.min(r,e.height-l)).data.buffer).some(u=>u!==0))return!1}return!0}function Ce(e,t){return!e||!t||e.type!==t.type?!1:e.type===g.Document?e.compatMode===t.compatMode:e.type===g.DocumentType?e.name===t.name&&e.publicId===t.publicId&&e.systemId===t.systemId:e.type===g.Comment||e.type===g.Text||e.type===g.CDATA?e.textContent===t.textContent:e.type===g.Element?e.tagName===t.tagName&&JSON.stringify(e.attributes)===JSON.stringify(t.attributes)&&e.isSVG===t.isSVG&&e.needBlock===t.needBlock:!1}function Ee(e){const t=e.type;return e.hasAttribute("data-rr-is-password")?"password":t?Y(t):null}function se(e,t){var a;let r;try{r=new URL(e,t!=null?t:window.location.href)}catch(f){return null}const i=/\.([0-9a-z]+)(?:$)/i,l=r.pathname.match(i);return(a=l==null?void 0:l[1])!=null?a:null}let Ne=1;const Be=new RegExp("[^a-z0-9-_:]"),re=-2;function ke(){return Ne++}function Ue(e){if(e instanceof HTMLFormElement)return"form";const t=Y(e.tagName);return Be.test(t)?"div":t}function ze(e){let t="";return e.indexOf("//")>-1?t=e.split("/").slice(0,3).join("/"):t=e.split("/")[0],t=t.split("?")[0],t}let G,le;const Ge=/url\((?:(')([^']*)'|(")(.*?)"|([^)]*))\)/gm,je=/^(?:[a-z+]+:)?\/\//i,He=/^www\..*/i,Ve=/^(data:)([^,]*),(.*)/i;function K(e,t){return(e||"").replace(Ge,(r,i,l,a,f,o)=>{const u=l||f||o,n=i||a||"";if(!u)return r;if(je.test(u)||He.test(u))return`url(${n}${u}${n})`;if(Ve.test(u))return`url(${n}${u}${n})`;if(u[0]==="/")return`url(${n}${ze(t)+u}${n})`;const c=t.split("/"),y=u.split("/");c.pop();for(const b of y)b!=="."&&(b===".."?c.pop():c.push(b));return`url(${n}${c.join("/")}${n})`})}const qe=/^[^ \t\n\r\u000c]+/,Ye=/^[, \t\n\r\u000c]+/;function Je(e,t){if(t.trim()==="")return t;let r=0;function i(a){let f;const o=a.exec(t.substring(r));return o?(f=o[0],r+=f.length,f):""}const l=[];for(;i(Ye),!(r>=t.length);){let a=i(qe);if(a.slice(-1)===",")a=j(e,a.substring(0,a.length-1)),l.push(a);else{let f="";a=j(e,a);let o=!1;for(;;){const u=t.charAt(r);if(u===""){l.push((a+f).trim());break}else if(o)u===")"&&(o=!1);else if(u===","){r+=1,l.push((a+f).trim());break}else u==="("&&(o=!0);f+=u,r+=1}}}return l.join(", ")}const ce=new WeakMap;function j(e,t){return!t||t.trim()===""?t:ee(e,t)}function Ke(e){return!!(e.tagName==="svg"||e.ownerSVGElement)}function ee(e,t){let r=ce.get(e);if(r||(r=e.createElement("a"),ce.set(e,r)),!t)t="";else if(t.startsWith("blob:")||t.startsWith("data:"))return t;return r.setAttribute("href",t),r.href}function xe(e,t,r,i){return i&&(r==="src"||r==="href"&&!(t==="use"&&i[0]==="#")||r==="xlink:href"&&i[0]!=="#"||r==="background"&&(t==="table"||t==="td"||t==="th")?j(e,i):r==="srcset"?Je(e,i):r==="style"?K(i,ee(e)):t==="object"&&r==="data"?j(e,i):i)}function Te(e,t,r){return(e==="video"||e==="audio")&&t==="autoplay"}function Xe(e,t,r){try{if(typeof t=="string"){if(e.classList.contains(t))return!0}else for(let i=e.classList.length;i--;){const l=e.classList[i];if(t.test(l))return!0}if(r)return e.matches(r)}catch(i){}return!1}function X(e,t,r){if(!e)return!1;if(e.nodeType!==e.ELEMENT_NODE)return r?X(e.parentNode,t,r):!1;for(let i=e.classList.length;i--;){const l=e.classList[i];if(t.test(l))return!0}return r?X(e.parentNode,t,r):!1}function Me(e,t,r,i){let l;if(Q(e)){if(l=e,!l.childNodes.length)return!1}else{if(e.parentElement===null)return!1;l=e.parentElement}try{if(typeof t=="string"){if(i){if(l.closest(`.${t}`))return!0}else if(l.classList.contains(t))return!0}else if(X(l,t,i))return!0;if(r){if(i){if(l.closest(r))return!0}else if(l.matches(r))return!0}}catch(a){}return!1}function Qe(e,t,r){const i=e.contentWindow;if(!i)return;let l=!1,a;try{a=i.document.readyState}catch(o){return}if(a!=="complete"){const o=setTimeout(()=>{l||(t(),l=!0)},r);e.addEventListener("load",()=>{clearTimeout(o),l=!0,t()});return}const f="about:blank";if(i.location.href!==f||e.src===f||e.src==="")return setTimeout(t,0),e.addEventListener("load",t);e.addEventListener("load",t)}function Ze(e,t,r){let i=!1,l;try{l=e.sheet}catch(f){return}if(l)return;const a=setTimeout(()=>{i||(t(),i=!0)},r);e.addEventListener("load",()=>{clearTimeout(a),i=!0,t()})}function et(e,t){const{doc:r,mirror:i,blockClass:l,blockSelector:a,needsMask:f,inlineStylesheet:o,maskInputOptions:u={},maskTextFn:n,maskInputFn:c,dataURLOptions:y={},inlineImages:b,recordCanvas:k,keepIframeSrcFn:w,newlyAddedElement:S=!1}=t,p=tt(r,i);switch(e.nodeType){case e.DOCUMENT_NODE:return e.compatMode!=="CSS1Compat"?{type:g.Document,childNodes:[],compatMode:e.compatMode}:{type:g.Document,childNodes:[]};case e.DOCUMENT_TYPE_NODE:return{type:g.DocumentType,name:e.name,publicId:e.publicId,systemId:e.systemId,rootId:p};case e.ELEMENT_NODE:return it(e,{doc:r,blockClass:l,blockSelector:a,inlineStylesheet:o,maskInputOptions:u,maskInputFn:c,dataURLOptions:y,inlineImages:b,recordCanvas:k,keepIframeSrcFn:w,newlyAddedElement:S,rootId:p});case e.TEXT_NODE:return rt(e,{doc:r,needsMask:f,maskTextFn:n,rootId:p});case e.CDATA_SECTION_NODE:return{type:g.CDATA,textContent:"",rootId:p};case e.COMMENT_NODE:return{type:g.Comment,textContent:e.textContent||"",rootId:p};default:return!1}}function tt(e,t){if(!t.hasNode(e))return;const r=t.getId(e);return r===1?void 0:r}function rt(e,t){var r;const{needsMask:i,maskTextFn:l,rootId:a}=t,f=e.parentNode&&e.parentNode.tagName;let o=e.textContent;const u=f==="STYLE"?!0:void 0,n=f==="SCRIPT"?!0:void 0;if(u&&o){try{e.nextSibling||e.previousSibling||(r=e.parentNode.sheet)!=null&&r.cssRules&&(o=q(e.parentNode.sheet))}catch(c){console.warn(`Cannot get CSS styles from text's parentNode. Error: ${c}`,e)}o=K(o,ee(t.doc))}return n&&(o="SCRIPT_PLACEHOLDER"),!u&&!n&&o&&i&&(o=l?l(o,e.parentElement):o.replace(/[\S]/g,"*")),{type:g.Text,textContent:o||"",isStyle:u,rootId:a}}function it(e,t){const{doc:r,blockClass:i,blockSelector:l,inlineStylesheet:a,maskInputOptions:f={},maskInputFn:o,dataURLOptions:u={},inlineImages:n,recordCanvas:c,keepIframeSrcFn:y,newlyAddedElement:b=!1,rootId:k}=t,w=Xe(e,i,l),S=Ue(e);let p={};const I=e.attributes.length;for(let m=0;m<I;m++){const C=e.attributes[m];Te(S,C.name,C.value)||(p[C.name]=xe(r,S,Y(C.name),C.value))}if(S==="link"&&a){const m=Array.from(r.styleSheets).find(T=>T.href===e.href);let C=null;m&&(C=q(m)),C&&(delete p.rel,delete p.href,p._cssText=K(C,m.href))}if(S==="style"&&e.sheet&&!(e.innerText||e.textContent||"").trim().length){const m=q(e.sheet);m&&(p._cssText=K(m,ee(r)))}if(S==="input"||S==="textarea"||S==="select"){const m=e.value,C=e.checked;p.type!=="radio"&&p.type!=="checkbox"&&p.type!=="submit"&&p.type!=="button"&&m?p.value=we({element:e,type:Ee(e),tagName:S,value:m,maskInputOptions:f,maskInputFn:o}):C&&(p.checked=C)}if(S==="option"&&(e.selected&&!f.select?p.selected=!0:delete p.selected),S==="canvas"&&c){if(e.__context==="2d")Se(e)||(p.rr_dataURL=e.toDataURL(u.type,u.quality));else if(!("__context"in e)){const m=e.toDataURL(u.type,u.quality),C=r.createElement("canvas");C.width=e.width,C.height=e.height;const T=C.toDataURL(u.type,u.quality);m!==T&&(p.rr_dataURL=m)}}if(S==="img"&&n){G||(G=r.createElement("canvas"),le=G.getContext("2d"));const m=e,C=m.currentSrc||m.getAttribute("src")||"<unknown-src>",T=m.crossOrigin,_=()=>{m.removeEventListener("load",_);try{G.width=m.naturalWidth,G.height=m.naturalHeight,le.drawImage(m,0,0),p.rr_dataURL=G.toDataURL(u.type,u.quality)}catch(z){if(m.crossOrigin!=="anonymous"){m.crossOrigin="anonymous",m.complete&&m.naturalWidth!==0?_():m.addEventListener("load",_);return}else console.warn(`Cannot inline img src=${C}! Error: ${z}`)}m.crossOrigin==="anonymous"&&(T?p.crossOrigin=T:m.removeAttribute("crossorigin"))};m.complete&&m.naturalWidth!==0?_():m.addEventListener("load",_)}if(S==="audio"||S==="video"){const m=p;m.rr_mediaState=e.paused?"paused":"played",m.rr_mediaCurrentTime=e.currentTime,m.rr_mediaPlaybackRate=e.playbackRate,m.rr_mediaMuted=e.muted,m.rr_mediaLoop=e.loop,m.rr_mediaVolume=e.volume}if(b||(e.scrollLeft&&(p.rr_scrollLeft=e.scrollLeft),e.scrollTop&&(p.rr_scrollTop=e.scrollTop)),w){const{width:m,height:C}=e.getBoundingClientRect();p={class:p.class,rr_width:`${m}px`,rr_height:`${C}px`}}S==="iframe"&&!y(p.src)&&(e.contentDocument||(p.rr_src=p.src),delete p.src);let R;try{customElements.get(S)&&(R=!0)}catch(m){}return{type:g.Element,tagName:S,attributes:p,childNodes:[],isSVG:Ke(e)||void 0,needBlock:w,rootId:k,isCustom:R}}function N(e){return e==null?"":e.toLowerCase()}function nt(e,t){if(t.comment&&e.type===g.Comment)return!0;if(e.type===g.Element){if(t.script&&(e.tagName==="script"||e.tagName==="link"&&(e.attributes.rel==="preload"||e.attributes.rel==="modulepreload")&&e.attributes.as==="script"||e.tagName==="link"&&e.attributes.rel==="prefetch"&&typeof e.attributes.href=="string"&&se(e.attributes.href)==="js"))return!0;if(t.headFavicon&&(e.tagName==="link"&&e.attributes.rel==="shortcut icon"||e.tagName==="meta"&&(N(e.attributes.name).match(/^msapplication-tile(image|color)$/)||N(e.attributes.name)==="application-name"||N(e.attributes.rel)==="icon"||N(e.attributes.rel)==="apple-touch-icon"||N(e.attributes.rel)==="shortcut icon")))return!0;if(e.tagName==="meta"){if(t.headMetaDescKeywords&&N(e.attributes.name).match(/^description|keywords$/))return!0;if(t.headMetaSocial&&(N(e.attributes.property).match(/^(og|twitter|fb):/)||N(e.attributes.name).match(/^(og|twitter):/)||N(e.attributes.name)==="pinterest"))return!0;if(t.headMetaRobots&&(N(e.attributes.name)==="robots"||N(e.attributes.name)==="googlebot"||N(e.attributes.name)==="bingbot"))return!0;if(t.headMetaHttpEquiv&&e.attributes["http-equiv"]!==void 0)return!0;if(t.headMetaAuthorship&&(N(e.attributes.name)==="author"||N(e.attributes.name)==="generator"||N(e.attributes.name)==="framework"||N(e.attributes.name)==="publisher"||N(e.attributes.name)==="progid"||N(e.attributes.property).match(/^article:/)||N(e.attributes.property).match(/^product:/)))return!0;if(t.headMetaVerification&&(N(e.attributes.name)==="google-site-verification"||N(e.attributes.name)==="yandex-verification"||N(e.attributes.name)==="csrf-token"||N(e.attributes.name)==="p:domain_verify"||N(e.attributes.name)==="verify-v1"||N(e.attributes.name)==="verification"||N(e.attributes.name)==="shopify-checkout-api-token"))return!0}}return!1}function H(e,t){const{doc:r,mirror:i,blockClass:l,blockSelector:a,maskTextClass:f,maskTextSelector:o,skipChild:u=!1,inlineStylesheet:n=!0,maskInputOptions:c={},maskTextFn:y,maskInputFn:b,slimDOMOptions:k,dataURLOptions:w={},inlineImages:S=!1,recordCanvas:p=!1,onSerialize:I,onIframeLoad:R,iframeLoadTimeout:m=5e3,onStylesheetLoad:C,stylesheetLoadTimeout:T=5e3,keepIframeSrcFn:_=()=>!1,newlyAddedElement:z=!1}=t;let{needsMask:L}=t,{preserveWhiteSpace:F=!0}=t;L||(L=Me(e,f,o,L===void 0));const O=et(e,{doc:r,mirror:i,blockClass:l,blockSelector:a,needsMask:L,inlineStylesheet:n,maskInputOptions:c,maskTextFn:y,maskInputFn:b,dataURLOptions:w,inlineImages:S,recordCanvas:p,keepIframeSrcFn:_,newlyAddedElement:z});if(!O)return console.warn(e,"not serialized"),null;let B;i.hasNode(e)?B=i.getId(e):nt(O,k)||!F&&O.type===g.Text&&!O.isStyle&&!O.textContent.replace(/^\s+|\s+$/gm,"").length?B=re:B=ke();const E=Object.assign(O,{id:B});if(i.add(e,E),B===re)return null;I&&I(e);let V=!u;if(E.type===g.Element){V=V&&!E.needBlock,delete E.needBlock;const v=e.shadowRoot;v&&J(v)&&(E.isShadowHost=!0)}if((E.type===g.Document||E.type===g.Element)&&V){k.headWhitespace&&E.type===g.Element&&E.tagName==="head"&&(F=!1);const v={doc:r,mirror:i,blockClass:l,blockSelector:a,needsMask:L,maskTextClass:f,maskTextSelector:o,skipChild:u,inlineStylesheet:n,maskInputOptions:c,maskTextFn:y,maskInputFn:b,slimDOMOptions:k,dataURLOptions:w,inlineImages:S,recordCanvas:p,preserveWhiteSpace:F,onSerialize:I,onIframeLoad:R,iframeLoadTimeout:m,onStylesheetLoad:C,stylesheetLoadTimeout:T,keepIframeSrcFn:_};if(!(E.type===g.Element&&E.tagName==="textarea"&&E.attributes.value!==void 0))for(const $ of Array.from(e.childNodes)){const P=H($,v);P&&E.childNodes.push(P)}if(Q(e)&&e.shadowRoot)for(const $ of Array.from(e.shadowRoot.childNodes)){const P=H($,v);P&&(J(e.shadowRoot)&&(P.isShadow=!0),E.childNodes.push(P))}}return e.parentNode&&pe(e.parentNode)&&J(e.parentNode)&&(E.isShadow=!0),E.type===g.Element&&E.tagName==="iframe"&&Qe(e,()=>{const v=e.contentDocument;if(v&&R){const $=H(v,{doc:v,mirror:i,blockClass:l,blockSelector:a,needsMask:L,maskTextClass:f,maskTextSelector:o,skipChild:!1,inlineStylesheet:n,maskInputOptions:c,maskTextFn:y,maskInputFn:b,slimDOMOptions:k,dataURLOptions:w,inlineImages:S,recordCanvas:p,preserveWhiteSpace:F,onSerialize:I,onIframeLoad:R,iframeLoadTimeout:m,onStylesheetLoad:C,stylesheetLoadTimeout:T,keepIframeSrcFn:_});$&&R(e,$)}},m),E.type===g.Element&&E.tagName==="link"&&typeof E.attributes.rel=="string"&&(E.attributes.rel==="stylesheet"||E.attributes.rel==="preload"&&typeof E.attributes.href=="string"&&se(E.attributes.href)==="css")&&Ze(e,()=>{if(C){const v=H(e,{doc:r,mirror:i,blockClass:l,blockSelector:a,needsMask:L,maskTextClass:f,maskTextSelector:o,skipChild:!1,inlineStylesheet:n,maskInputOptions:c,maskTextFn:y,maskInputFn:b,slimDOMOptions:k,dataURLOptions:w,inlineImages:S,recordCanvas:p,preserveWhiteSpace:F,onSerialize:I,onIframeLoad:R,iframeLoadTimeout:m,onStylesheetLoad:C,stylesheetLoadTimeout:T,keepIframeSrcFn:_});v&&C(e,v)}},T),E}function st(e,t){const{mirror:r=new Z,blockClass:i="rr-block",blockSelector:l=null,maskTextClass:a="rr-mask",maskTextSelector:f=null,inlineStylesheet:o=!0,inlineImages:u=!1,recordCanvas:n=!1,maskAllInputs:c=!1,maskTextFn:y,maskInputFn:b,slimDOM:k=!1,dataURLOptions:w,preserveWhiteSpace:S,onSerialize:p,onIframeLoad:I,iframeLoadTimeout:R,onStylesheetLoad:m,stylesheetLoadTimeout:C,keepIframeSrcFn:T=()=>!1}=t||{};return H(e,{doc:e,mirror:r,blockClass:i,blockSelector:l,maskTextClass:a,maskTextSelector:f,skipChild:!1,inlineStylesheet:o,maskInputOptions:c===!0?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,password:!0}:c===!1?{password:!0}:c,maskTextFn:y,maskInputFn:b,slimDOMOptions:k===!0||k==="all"?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaDescKeywords:k==="all",headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaAuthorship:!0,headMetaVerification:!0}:k===!1?{}:k,dataURLOptions:w,inlineImages:u,recordCanvas:n,preserveWhiteSpace:S,onSerialize:p,onIframeLoad:I,iframeLoadTimeout:R,onStylesheetLoad:m,stylesheetLoadTimeout:C,keepIframeSrcFn:T,newlyAddedElement:!1})}function ot(e,t){function r(i){t(i),(i.type===g.Document||i.type===g.Element)&&i.childNodes.forEach(r)}r(e)}function at(){Ne=1}const ue=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g;function lt(e,t={}){let r=1,i=1;function l(d){const s=d.match(/\n/g);s&&(r+=s.length);const h=d.lastIndexOf(`
`);i=h===-1?i+d.length:d.length-h}function a(){const d={line:r,column:i};return s=>(s.position=new o(d),S(),s)}const f=class ve{constructor(s){U(this,"content"),U(this,"start"),U(this,"end"),U(this,"source"),this.start=s,this.end={line:r,column:i},this.source=t.source,this.content=ve.content}};U(f,"content");let o=f;o.content=e;const u=[];function n(d){const s=new Error(`${t.source||""}:${r}:${i}: ${d}`);if(s.reason=d,s.filename=t.source,s.line=r,s.column=i,s.source=e,t.silent)u.push(s);else throw s}function c(){const d=k();return{type:"stylesheet",stylesheet:{source:t.source,rules:d,parsingErrors:u}}}function y(){return w(/^{\s*/)}function b(){return w(/^}/)}function k(){let d;const s=[];for(S(),p(s);e.length&&e.charAt(0)!=="}"&&(d=De()||Ae());)d&&(s.push(d),p(s));return s}function w(d){const s=d.exec(e);if(!s)return;const h=s[0];return l(h),e=e.slice(h.length),s}function S(){w(/^\s*/)}function p(d=[]){let s;for(;s=I();)s&&d.push(s),s=I();return d}function I(){const d=a();if(e.charAt(0)!=="/"||e.charAt(1)!=="*")return;let s=2;for(;e.charAt(s)!==""&&(e.charAt(s)!=="*"||e.charAt(s+1)!=="/");)++s;if(s+=2,e.charAt(s-1)==="")return n("End of comment missing");const h=e.slice(2,s-2);return i+=2,l(h),e=e.slice(s),i+=2,d({type:"comment",comment:h})}const R=new RegExp("^(("+[/[^\\]"(?:\\"|[^"])*"/.source,/[^\\]'(?:\\'|[^'])*'/.source,"[^{]"].join("|")+")+)");function m(){for(S();e[0]=="}";)n("extra closing bracket"),e=e.slice(1),S();const d=w(R);if(!d)return;const s=d[0].trim().replace(/\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*\/+/g,"").replace(/"(?:\\"|[^"])*"|'(?:\\'|[^'])*'/g,h=>h.replace(/,/g,"\u200C"));return C(s).map(h=>h.replace(/\u200C/g,",").trim())}function C(d){const s=[];let h="",x=0,M=0,D=null;for(const A of d){const Oe=h.endsWith("\\");D?D===A&&!Oe&&(D=null):A==="("?x++:A===")"?x--:A==="["?M++:A==="]"?M--:`'"`.includes(A)&&(D=A),A===","&&x===0&&M===0?(s.push(h),h=""):h+=A}return h&&s.push(h),s}function T(){const d=a(),s=w(/^(\*?[-#\/\*\\\w]+(\[[0-9a-z_-]+\])?)\s*/);if(!s)return;const h=W(s[0]);if(!w(/^:\s*/))return n("property missing ':'");const x=w(/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^\)]*?\)|[^};])+)/),M=d({type:"declaration",property:h.replace(ue,""),value:x?W(x[0]).replace(ue,""):""});return w(/^[;\s]*/),M}function _(){const d=[];if(!y())return n("missing '{'");p(d);let s;for(;s=T();)s!==!1&&(d.push(s),p(d)),s=T();return b()?d:n("missing '}'")}function z(){let d;const s=[],h=a();for(;d=w(/^((\d+\.\d+|\.\d+|\d+)%?|[a-z]+)\s*/);)s.push(d[1]),w(/^,\s*/);if(s.length)return h({type:"keyframe",values:s,declarations:_()})}function L(){const d=a();let s=w(/^@([-\w]+)?keyframes\s*/);if(!s)return;const h=s[1];if(s=w(/^([-\w]+)\s*/),!s)return n("@keyframes missing name");const x=s[1];if(!y())return n("@keyframes missing '{'");let M,D=p();for(;M=z();)D.push(M),D=D.concat(p());return b()?d({type:"keyframes",name:x,vendor:h,keyframes:D}):n("@keyframes missing '}'")}function F(){const d=a(),s=w(/^@supports *([^{]+)/);if(!s)return;const h=W(s[1]);if(!y())return n("@supports missing '{'");const x=p().concat(k());return b()?d({type:"supports",supports:h,rules:x}):n("@supports missing '}'")}function O(){const d=a();if(!w(/^@host\s*/))return;if(!y())return n("@host missing '{'");const h=p().concat(k());return b()?d({type:"host",rules:h}):n("@host missing '}'")}function B(){const d=a(),s=w(/^@media *([^{]+)/);if(!s)return;const h=W(s[1]);if(!y())return n("@media missing '{'");const x=p().concat(k());return b()?d({type:"media",media:h,rules:x}):n("@media missing '}'")}function E(){const d=a(),s=w(/^@custom-media\s+(--[^\s]+)\s*([^{;]+);/);if(s)return d({type:"custom-media",name:W(s[1]),media:W(s[2])})}function V(){const d=a();if(!w(/^@page */))return;const h=m()||[];if(!y())return n("@page missing '{'");let x=p(),M;for(;M=T();)x.push(M),x=x.concat(p());return b()?d({type:"page",selectors:h,declarations:x}):n("@page missing '}'")}function v(){const d=a(),s=w(/^@([-\w]+)?document *([^{]+)/);if(!s)return;const h=W(s[1]),x=W(s[2]);if(!y())return n("@document missing '{'");const M=p().concat(k());return b()?d({type:"document",document:x,vendor:h,rules:M}):n("@document missing '}'")}function $(){const d=a();if(!w(/^@font-face\s*/))return;if(!y())return n("@font-face missing '{'");let h=p(),x;for(;x=T();)h.push(x),h=h.concat(p());return b()?d({type:"font-face",declarations:h}):n("@font-face missing '}'")}const P=te("import"),Re=te("charset"),Le=te("namespace");function te(d){const s=new RegExp("^@"+d+"\\s*((?:"+[/[^\\]"(?:\\"|[^"])*"/.source,/[^\\]'(?:\\'|[^'])*'/.source,"[^;]"].join("|")+")+);");return()=>{const h=a(),x=w(s);if(!x)return;const M={type:d};return M[d]=x[1].trim(),h(M)}}function De(){if(e[0]==="@")return L()||B()||E()||F()||P()||Re()||Le()||v()||V()||O()||$()}function Ae(){const d=a(),s=m();return s?(p(),d({type:"rule",selectors:s,declarations:_()})):n("selector missing")}return ie(c())}function W(e){return e?e.replace(/^\s+|\s+$/g,""):""}function ie(e,t){const r=e&&typeof e.type=="string",i=r?e:t;for(const l of Object.keys(e)){const a=e[l];Array.isArray(a)?a.forEach(f=>{ie(f,i)}):a&&typeof a=="object"&&ie(a,i)}return r&&Object.defineProperty(e,"parent",{configurable:!0,writable:!0,enumerable:!1,value:t||null}),e}const fe={script:"noscript",altglyph:"altGlyph",altglyphdef:"altGlyphDef",altglyphitem:"altGlyphItem",animatecolor:"animateColor",animatemotion:"animateMotion",animatetransform:"animateTransform",clippath:"clipPath",feblend:"feBlend",fecolormatrix:"feColorMatrix",fecomponenttransfer:"feComponentTransfer",fecomposite:"feComposite",feconvolvematrix:"feConvolveMatrix",fediffuselighting:"feDiffuseLighting",fedisplacementmap:"feDisplacementMap",fedistantlight:"feDistantLight",fedropshadow:"feDropShadow",feflood:"feFlood",fefunca:"feFuncA",fefuncb:"feFuncB",fefuncg:"feFuncG",fefuncr:"feFuncR",fegaussianblur:"feGaussianBlur",feimage:"feImage",femerge:"feMerge",femergenode:"feMergeNode",femorphology:"feMorphology",feoffset:"feOffset",fepointlight:"fePointLight",fespecularlighting:"feSpecularLighting",fespotlight:"feSpotLight",fetile:"feTile",feturbulence:"feTurbulence",foreignobject:"foreignObject",glyphref:"glyphRef",lineargradient:"linearGradient",radialgradient:"radialGradient"};function ct(e){let t=fe[e.tagName]?fe[e.tagName]:e.tagName;return t==="link"&&e.attributes._cssText&&(t="style"),t}function de(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}const _e=/(max|min)-device-(width|height)/,ut=new RegExp(_e.source,"g"),Ie=/([^\\]):hover/,ft=new RegExp(Ie.source,"g");function ne(e,t){const r=t==null?void 0:t.stylesWithHoverClass.get(e);if(r)return r;const i=lt(e,{silent:!0});if(!i.stylesheet)return e;const l=[],a=[];function f(u){"selectors"in u&&u.selectors&&u.selectors.forEach(n=>{Ie.test(n)&&l.push(n)}),"media"in u&&u.media&&_e.test(u.media)&&a.push(u.media),"rules"in u&&u.rules&&u.rules.forEach(f)}f(i.stylesheet);let o=e;if(l.length>0){const u=new RegExp(l.filter((n,c)=>l.indexOf(n)===c).sort((n,c)=>c.length-n.length).map(n=>de(n)).join("|"),"g");o=o.replace(u,n=>{const c=n.replace(ft,"$1.\\:hover");return`${n}, ${c}`})}if(a.length>0){const u=new RegExp(a.filter((n,c)=>a.indexOf(n)===c).sort((n,c)=>c.length-n.length).map(n=>de(n)).join("|"),"g");o=o.replace(u,n=>n.replace(ut,"$1-$2"))}return t==null||t.stylesWithHoverClass.set(e,o),o}function dt(){return{stylesWithHoverClass:new Map}}function pt(e,t){var r;const{doc:i,hackCss:l,cache:a}=t;switch(e.type){case g.Document:return i.implementation.createDocument(null,"",null);case g.DocumentType:return i.implementation.createDocumentType(e.name||"html",e.publicId,e.systemId);case g.Element:{const f=ct(e);let o;e.isSVG?o=i.createElementNS("http://www.w3.org/2000/svg",f):(e.isCustom&&((r=i.defaultView)!=null&&r.customElements)&&!i.defaultView.customElements.get(e.tagName)&&i.defaultView.customElements.define(e.tagName,class extends i.defaultView.HTMLElement{}),o=i.createElement(f));const u={};for(const n in e.attributes){if(!Object.prototype.hasOwnProperty.call(e.attributes,n))continue;let c=e.attributes[n];if(f==="option"&&n==="selected"&&c===!1||c===null)continue;if(c===!0&&(c=""),n.startsWith("rr_")){u[n]=c;continue}const y=f==="textarea"&&n==="value",b=f==="style"&&n==="_cssText";if(b&&l&&typeof c=="string"&&(c=ne(c,a)),(y||b)&&typeof c=="string"){o.appendChild(i.createTextNode(c)),e.childNodes=[];continue}try{if(e.isSVG&&n==="xlink:href")o.setAttributeNS("http://www.w3.org/1999/xlink",n,c.toString());else if(n==="onload"||n==="onclick"||n.substring(0,7)==="onmouse")o.setAttribute("_"+n,c.toString());else if(f==="meta"&&e.attributes["http-equiv"]==="Content-Security-Policy"&&n==="content"){o.setAttribute("csp-content",c.toString());continue}else f==="link"&&(e.attributes.rel==="preload"||e.attributes.rel==="modulepreload")&&e.attributes.as==="script"||f==="link"&&e.attributes.rel==="prefetch"&&typeof e.attributes.href=="string"&&e.attributes.href.endsWith(".js")||(f==="img"&&e.attributes.srcset&&e.attributes.rr_dataURL?o.setAttribute("rrweb-original-srcset",e.attributes.srcset):o.setAttribute(n,c.toString()))}catch(k){}}for(const n in u){const c=u[n];if(f==="canvas"&&n==="rr_dataURL"){const y=i.createElement("img");y.onload=()=>{const b=o.getContext("2d");b&&b.drawImage(y,0,0,y.width,y.height)},y.src=c.toString(),o.RRNodeType&&(o.rr_dataURL=c.toString())}else if(f==="img"&&n==="rr_dataURL"){const y=o;y.currentSrc.startsWith("data:")||(y.setAttribute("rrweb-original-src",e.attributes.src),y.src=c.toString())}if(n==="rr_width")o.style.width=c.toString();else if(n==="rr_height")o.style.height=c.toString();else if(n==="rr_mediaCurrentTime"&&typeof c=="number")o.currentTime=c;else if(n==="rr_mediaState")switch(c){case"played":o.play().catch(y=>console.warn("media playback error",y));break;case"paused":o.pause();break}else n==="rr_mediaPlaybackRate"&&typeof c=="number"?o.playbackRate=c:n==="rr_mediaMuted"&&typeof c=="boolean"?o.muted=c:n==="rr_mediaLoop"&&typeof c=="boolean"?o.loop=c:n==="rr_mediaVolume"&&typeof c=="number"&&(o.volume=c)}if(e.isShadowHost)if(!o.shadowRoot)o.attachShadow({mode:"open"});else for(;o.shadowRoot.firstChild;)o.shadowRoot.removeChild(o.shadowRoot.firstChild);return o}case g.Text:return i.createTextNode(e.isStyle&&l?ne(e.textContent,a):e.textContent);case g.CDATA:return i.createCDATASection(e.textContent);case g.Comment:return i.createComment(e.textContent);default:return null}}function oe(e,t){const{doc:r,mirror:i,skipChild:l=!1,hackCss:a=!0,afterAppend:f,cache:o}=t;if(i.has(e.id)){const n=i.getNode(e.id),c=i.getMeta(n);if(Ce(c,e))return i.getNode(e.id)}let u=pt(e,{doc:r,hackCss:a,cache:o});if(!u)return null;if(e.rootId&&i.getNode(e.rootId)!==r&&i.replace(e.rootId,r),e.type===g.Document&&(r.close(),r.open(),e.compatMode==="BackCompat"&&e.childNodes&&e.childNodes[0].type!==g.DocumentType&&(e.childNodes[0].type===g.Element&&"xmlns"in e.childNodes[0].attributes&&e.childNodes[0].attributes.xmlns==="http://www.w3.org/1999/xhtml"?r.write('<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "">'):r.write('<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "">')),u=r),i.add(u,e),(e.type===g.Document||e.type===g.Element)&&!l)for(const n of e.childNodes){const c=oe(n,{doc:r,mirror:i,skipChild:!1,hackCss:a,afterAppend:f,cache:o});if(!c){console.warn("Failed to rebuild",n);continue}if(n.isShadow&&Q(u)&&u.shadowRoot)u.shadowRoot.appendChild(c);else if(e.type===g.Document&&n.type==g.Element){const y=c;let b=null;y.childNodes.forEach(k=>{k.nodeName==="BODY"&&(b=k)}),b?(y.removeChild(b),u.appendChild(c),y.appendChild(b)):u.appendChild(c)}else u.appendChild(c);f&&f(c,n.id)}return u}function mt(e,t){function r(i){t(i)}for(const i of e.getIds())e.has(i)&&r(e.getNode(i))}function ht(e,t){const r=t.getMeta(e);if((r==null?void 0:r.type)!==g.Element)return;const i=e;for(const l in r.attributes){if(!(Object.prototype.hasOwnProperty.call(r.attributes,l)&&l.startsWith("rr_")))continue;const a=r.attributes[l];l==="rr_scrollLeft"&&(i.scrollLeft=a),l==="rr_scrollTop"&&(i.scrollTop=a)}}function gt(e,t){const{doc:r,onVisit:i,hackCss:l=!0,afterAppend:a,cache:f,mirror:o=new Z}=t,u=oe(e,{doc:r,mirror:o,skipChild:!1,hackCss:l,afterAppend:a,cache:f});return mt(o,n=>{i&&i(n),ht(n,o)}),u}exports.IGNORED_NODE=re;exports.Mirror=Z;exports.NodeType=g;exports.adaptCssForReplay=ne;exports.buildNodeWithSN=oe;exports.classMatchesRegex=X;exports.cleanupSnapshot=at;exports.createCache=dt;exports.createMirror=Fe;exports.escapeImportStatement=me;exports.extractFileExtension=se;exports.fixSafariColons=ge;exports.genId=ke;exports.getInputType=Ee;exports.ignoreAttribute=Te;exports.is2DCanvasBlank=Se;exports.isCSSImportRule=ye;exports.isCSSStyleRule=be;exports.isElement=Q;exports.isNativeShadowDom=J;exports.isNodeMetaEqual=Ce;exports.isShadowRoot=pe;exports.maskInputValue=we;exports.needMaskingText=Me;exports.rebuild=gt;exports.serializeNodeWithId=H;exports.snapshot=st;exports.stringifyRule=he;exports.stringifyStylesheet=q;exports.toLowerCase=Y;exports.transformAttribute=xe;exports.visitSnapshot=ot;
if (typeof module.exports == "object" && typeof exports == "object") {
  var __cp = (to, from, except, desc) => {
    if ((from && typeof from === "object") || typeof from === "function") {
      for (let key of Object.getOwnPropertyNames(from)) {
        if (!Object.prototype.hasOwnProperty.call(to, key) && key !== except)
        Object.defineProperty(to, key, {
          get: () => from[key],
          enumerable: !(desc = Object.getOwnPropertyDescriptor(from, key)) || desc.enumerable,
        });
      }
    }
    return to;
  };
  module.exports = __cp(module.exports, exports);
}
return module.exports;
}))
//# sourceMappingURL=rrweb-snapshot.umd.min.cjs.map
