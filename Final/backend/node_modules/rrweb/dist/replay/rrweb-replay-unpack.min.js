var rrwebReplay=function(pe){"use strict";var _;(function(e){e[e.Document=0]="Document",e[e.DocumentType=1]="DocumentType",e[e.Element=2]="Element",e[e.Text=3]="Text",e[e.CDATA=4]="CDATA",e[e.Comment=5]="Comment"})(_||(_={}));function _t(e){return e.nodeType===e.ELEMENT_NODE}var Fe=function(){function e(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}return e.prototype.getId=function(t){var n;if(!t)return-1;var r=(n=this.getMeta(t))===null||n===void 0?void 0:n.id;return r??-1},e.prototype.getNode=function(t){return this.idNodeMap.get(t)||null},e.prototype.getIds=function(){return Array.from(this.idNodeMap.keys())},e.prototype.getMeta=function(t){return this.nodeMetaMap.get(t)||null},e.prototype.removeNodeFromMap=function(t){var n=this,r=this.getId(t);this.idNodeMap.delete(r),t.childNodes&&t.childNodes.forEach(function(i){return n.removeNodeFromMap(i)})},e.prototype.has=function(t){return this.idNodeMap.has(t)},e.prototype.hasNode=function(t){return this.nodeMetaMap.has(t)},e.prototype.add=function(t,n){var r=n.id;this.idNodeMap.set(r,t),this.nodeMetaMap.set(t,n)},e.prototype.replace=function(t,n){var r=this.getNode(t);if(r){var i=this.nodeMetaMap.get(r);i&&this.nodeMetaMap.set(n,i)}this.idNodeMap.set(t,n)},e.prototype.reset=function(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap},e}();function Lt(){return new Fe}var Pe=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g;function Ft(e,t){t===void 0&&(t={});var n=1,r=1;function i(g){var h=g.match(/\n/g);h&&(n+=h.length);var b=g.lastIndexOf(`
`);r=b===-1?r+g.length:g.length-b}function l(){var g={line:n,column:r};return function(h){return h.position=new o(g),N(),h}}var o=function(){function g(h){this.start=h,this.end={line:n,column:r},this.source=t.source}return g}();o.prototype.content=e;var a=[];function s(g){var h=new Error("".concat(t.source||"",":").concat(n,":").concat(r,": ").concat(g));if(h.reason=g,h.filename=t.source,h.line=n,h.column=r,h.source=e,t.silent)a.push(h);else throw h}function c(){var g=m();return{type:"stylesheet",stylesheet:{source:t.source,rules:g,parsingErrors:a}}}function u(){return f(/^{\s*/)}function d(){return f(/^}/)}function m(){var g,h=[];for(N(),E(h);e.length&&e.charAt(0)!=="}"&&(g=k()||K());)g!==!1&&(h.push(g),E(h));return h}function f(g){var h=g.exec(e);if(h){var b=h[0];return i(b),e=e.slice(b.length),h}}function N(){f(/^\s*/)}function E(g){g===void 0&&(g=[]);for(var h;h=y();)h!==!1&&g.push(h),h=y();return g}function y(){var g=l();if(!(e.charAt(0)!=="/"||e.charAt(1)!=="*")){for(var h=2;e.charAt(h)!==""&&(e.charAt(h)!=="*"||e.charAt(h+1)!=="/");)++h;if(h+=2,e.charAt(h-1)==="")return s("End of comment missing");var b=e.slice(2,h-2);return r+=2,i(b),e=e.slice(h),r+=2,g({type:"comment",comment:b})}}function p(){var g=f(/^([^{]+)/);if(g)return Y(g[0]).replace(/\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*\/+/g,"").replace(/"(?:\\"|[^"])*"|'(?:\\'|[^'])*'/g,function(h){return h.replace(/,/g,"\u200C")}).split(/\s*(?![^(]*\)),\s*/).map(function(h){return h.replace(/\u200C/g,",")})}function v(){var g=l(),h=f(/^(\*?[-#\/\*\\\w]+(\[[0-9a-z_-]+\])?)\s*/);if(h){var b=Y(h[0]);if(!f(/^:\s*/))return s("property missing ':'");var C=f(/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^\)]*?\)|[^};])+)/),F=g({type:"declaration",property:b.replace(Pe,""),value:C?Y(C[0]).replace(Pe,""):""});return f(/^[;\s]*/),F}}function w(){var g=[];if(!u())return s("missing '{'");E(g);for(var h;h=v();)h!==!1&&(g.push(h),E(g)),h=v();return d()?g:s("missing '}'")}function T(){for(var g,h=[],b=l();g=f(/^((\d+\.\d+|\.\d+|\d+)%?|[a-z]+)\s*/);)h.push(g[1]),f(/^,\s*/);if(h.length)return b({type:"keyframe",values:h,declarations:w()})}function x(){var g=l(),h=f(/^@([-\w]+)?keyframes\s*/);if(h){var b=h[1];if(h=f(/^([-\w]+)\s*/),!h)return s("@keyframes missing name");var C=h[1];if(!u())return s("@keyframes missing '{'");for(var F,J=E();F=T();)J.push(F),J=J.concat(E());return d()?g({type:"keyframes",name:C,vendor:b,keyframes:J}):s("@keyframes missing '}'")}}function A(){var g=l(),h=f(/^@supports *([^{]+)/);if(h){var b=Y(h[1]);if(!u())return s("@supports missing '{'");var C=E().concat(m());return d()?g({type:"supports",supports:b,rules:C}):s("@supports missing '}'")}}function $(){var g=l(),h=f(/^@host\s*/);if(h){if(!u())return s("@host missing '{'");var b=E().concat(m());return d()?g({type:"host",rules:b}):s("@host missing '}'")}}function L(){var g=l(),h=f(/^@media *([^{]+)/);if(h){var b=Y(h[1]);if(!u())return s("@media missing '{'");var C=E().concat(m());return d()?g({type:"media",media:b,rules:C}):s("@media missing '}'")}}function Z(){var g=l(),h=f(/^@custom-media\s+(--[^\s]+)\s*([^{;]+);/);if(h)return g({type:"custom-media",name:Y(h[1]),media:Y(h[2])})}function de(){var g=l(),h=f(/^@page */);if(h){var b=p()||[];if(!u())return s("@page missing '{'");for(var C=E(),F;F=v();)C.push(F),C=C.concat(E());return d()?g({type:"page",selectors:b,declarations:C}):s("@page missing '}'")}}function he(){var g=l(),h=f(/^@([-\w]+)?document *([^{]+)/);if(h){var b=Y(h[1]),C=Y(h[2]);if(!u())return s("@document missing '{'");var F=E().concat(m());return d()?g({type:"document",document:C,vendor:b,rules:F}):s("@document missing '}'")}}function Q(){var g=l(),h=f(/^@font-face\s*/);if(h){if(!u())return s("@font-face missing '{'");for(var b=E(),C;C=v();)b.push(C),b=b.concat(E());return d()?g({type:"font-face",declarations:b}):s("@font-face missing '}'")}}var G=B("import"),q=B("charset"),oe=B("namespace");function B(g){var h=new RegExp("^@"+g+"\\s*([^;]+);");return function(){var b=l(),C=f(h);if(C){var F={type:g};return F[g]=C[1].trim(),b(F)}}}function k(){if(e[0]==="@")return x()||L()||Z()||A()||G()||q()||oe()||he()||de()||$()||Q()}function K(){var g=l(),h=p();return h?(E(),g({type:"rule",selectors:h,declarations:w()})):s("selector missing")}return Ee(c())}function Y(e){return e?e.replace(/^\s+|\s+$/g,""):""}function Ee(e,t){for(var n=e&&typeof e.type=="string",r=n?e:t,i=0,l=Object.keys(e);i<l.length;i++){var o=l[i],a=e[o];Array.isArray(a)?a.forEach(function(s){Ee(s,r)}):a&&typeof a=="object"&&Ee(a,r)}return n&&Object.defineProperty(e,"parent",{configurable:!0,writable:!0,enumerable:!1,value:t||null}),e}var Be={script:"noscript",altglyph:"altGlyph",altglyphdef:"altGlyphDef",altglyphitem:"altGlyphItem",animatecolor:"animateColor",animatemotion:"animateMotion",animatetransform:"animateTransform",clippath:"clipPath",feblend:"feBlend",fecolormatrix:"feColorMatrix",fecomponenttransfer:"feComponentTransfer",fecomposite:"feComposite",feconvolvematrix:"feConvolveMatrix",fediffuselighting:"feDiffuseLighting",fedisplacementmap:"feDisplacementMap",fedistantlight:"feDistantLight",fedropshadow:"feDropShadow",feflood:"feFlood",fefunca:"feFuncA",fefuncb:"feFuncB",fefuncg:"feFuncG",fefuncr:"feFuncR",fegaussianblur:"feGaussianBlur",feimage:"feImage",femerge:"feMerge",femergenode:"feMergeNode",femorphology:"feMorphology",feoffset:"feOffset",fepointlight:"fePointLight",fespecularlighting:"feSpecularLighting",fespotlight:"feSpotLight",fetile:"feTile",feturbulence:"feTurbulence",foreignobject:"foreignObject",glyphref:"glyphRef",lineargradient:"linearGradient",radialgradient:"radialGradient"};function Pt(e){var t=Be[e.tagName]?Be[e.tagName]:e.tagName;return t==="link"&&e.attributes._cssText&&(t="style"),t}function Bt(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}var Ue=/([^\\]):hover/,Ut=new RegExp(Ue.source,"g");function $e(e,t){var n=t?.stylesWithHoverClass.get(e);if(n)return n;var r=Ft(e,{silent:!0});if(!r.stylesheet)return e;var i=[];if(r.stylesheet.rules.forEach(function(a){"selectors"in a&&(a.selectors||[]).forEach(function(s){Ue.test(s)&&i.push(s)})}),i.length===0)return e;var l=new RegExp(i.filter(function(a,s){return i.indexOf(a)===s}).sort(function(a,s){return s.length-a.length}).map(function(a){return Bt(a)}).join("|"),"g"),o=e.replace(l,function(a){var s=a.replace(Ut,"$1.\\:hover");return"".concat(a,", ").concat(s)});return t?.stylesWithHoverClass.set(e,o),o}function We(){var e=new Map;return{stylesWithHoverClass:e}}function $t(e,t){var n=t.doc,r=t.hackCss,i=t.cache;switch(e.type){case _.Document:return n.implementation.createDocument(null,"",null);case _.DocumentType:return n.implementation.createDocumentType(e.name||"html",e.publicId,e.systemId);case _.Element:{var l=Pt(e),o;e.isSVG?o=n.createElementNS("http://www.w3.org/2000/svg",l):o=n.createElement(l);var a={};for(var s in e.attributes)if(Object.prototype.hasOwnProperty.call(e.attributes,s)){var c=e.attributes[s];if(!(l==="option"&&s==="selected"&&c===!1)){if(c===!0&&(c=""),s.startsWith("rr_")){a[s]=c;continue}var u=l==="textarea"&&s==="value",d=l==="style"&&s==="_cssText";if(d&&r&&typeof c=="string"&&(c=$e(c,i)),(u||d)&&typeof c=="string"){for(var m=n.createTextNode(c),f=0,N=Array.from(o.childNodes);f<N.length;f++){var E=N[f];E.nodeType===o.TEXT_NODE&&o.removeChild(E)}o.appendChild(m);continue}try{if(e.isSVG&&s==="xlink:href")o.setAttributeNS("http://www.w3.org/1999/xlink",s,c.toString());else if(s==="onload"||s==="onclick"||s.substring(0,7)==="onmouse")o.setAttribute("_"+s,c.toString());else if(l==="meta"&&e.attributes["http-equiv"]==="Content-Security-Policy"&&s==="content"){o.setAttribute("csp-content",c.toString());continue}else l==="link"&&e.attributes.rel==="preload"&&e.attributes.as==="script"||l==="link"&&e.attributes.rel==="prefetch"&&typeof e.attributes.href=="string"&&e.attributes.href.endsWith(".js")||(l==="img"&&e.attributes.srcset&&e.attributes.rr_dataURL?o.setAttribute("rrweb-original-srcset",e.attributes.srcset):o.setAttribute(s,c.toString()))}catch{}}}var y=function(v){var w=a[v];if(l==="canvas"&&v==="rr_dataURL"){var T=document.createElement("img");T.onload=function(){var A=o.getContext("2d");A&&A.drawImage(T,0,0,T.width,T.height)},T.src=w.toString(),o.RRNodeType&&(o.rr_dataURL=w.toString())}else if(l==="img"&&v==="rr_dataURL"){var x=o;x.currentSrc.startsWith("data:")||(x.setAttribute("rrweb-original-src",e.attributes.src),x.src=w.toString())}if(v==="rr_width")o.style.width=w.toString();else if(v==="rr_height")o.style.height=w.toString();else if(v==="rr_mediaCurrentTime"&&typeof w=="number")o.currentTime=w;else if(v==="rr_mediaState")switch(w){case"played":o.play().catch(function(A){return console.warn("media playback error",A)});break;case"paused":o.pause();break}};for(var p in a)y(p);if(e.isShadowHost)if(!o.shadowRoot)o.attachShadow({mode:"open"});else for(;o.shadowRoot.firstChild;)o.shadowRoot.removeChild(o.shadowRoot.firstChild);return o}case _.Text:return n.createTextNode(e.isStyle&&r?$e(e.textContent,i):e.textContent);case _.CDATA:return n.createCDATASection(e.textContent);case _.Comment:return n.createComment(e.textContent);default:return null}}function ie(e,t){var n=t.doc,r=t.mirror,i=t.skipChild,l=i===void 0?!1:i,o=t.hackCss,a=o===void 0?!0:o,s=t.afterAppend,c=t.cache,u=$t(e,{doc:n,hackCss:a,cache:c});if(!u)return null;if(e.rootId&&r.getNode(e.rootId)!==n&&r.replace(e.rootId,n),e.type===_.Document&&(n.close(),n.open(),e.compatMode==="BackCompat"&&e.childNodes&&e.childNodes[0].type!==_.DocumentType&&(e.childNodes[0].type===_.Element&&"xmlns"in e.childNodes[0].attributes&&e.childNodes[0].attributes.xmlns==="http://www.w3.org/1999/xhtml"?n.write('<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "">'):n.write('<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "">')),u=n),r.add(u,e),(e.type===_.Document||e.type===_.Element)&&!l)for(var d=0,m=e.childNodes;d<m.length;d++){var f=m[d],N=ie(f,{doc:n,mirror:r,skipChild:!1,hackCss:a,afterAppend:s,cache:c});if(!N){console.warn("Failed to rebuild",f);continue}f.isShadow&&_t(u)&&u.shadowRoot?u.shadowRoot.appendChild(N):u.appendChild(N),s&&s(N,f.id)}return u}function Wt(e,t){function n(o){t(o)}for(var r=0,i=e.getIds();r<i.length;r++){var l=i[r];e.has(l)&&n(e.getNode(l))}}function Vt(e,t){var n=t.getMeta(e);if(n?.type===_.Element){var r=e;for(var i in n.attributes)if(Object.prototype.hasOwnProperty.call(n.attributes,i)&&i.startsWith("rr_")){var l=n.attributes[i];i==="rr_scrollLeft"&&(r.scrollLeft=l),i==="rr_scrollTop"&&(r.scrollTop=l)}}}function Gt(e,t){var n=t.doc,r=t.onVisit,i=t.hackCss,l=i===void 0?!0:i,o=t.afterAppend,a=t.cache,s=t.mirror,c=s===void 0?new Fe:s,u=ie(e,{doc:n,mirror:c,skipChild:!1,hackCss:l,afterAppend:o,cache:a});return Wt(c,function(d){r&&r(d),Vt(d,c)}),u}var S;(function(e){e[e.Document=0]="Document",e[e.DocumentType=1]="DocumentType",e[e.Element=2]="Element",e[e.Text=3]="Text",e[e.CDATA=4]="CDATA",e[e.Comment=5]="Comment"})(S||(S={}));var jt=function(){function e(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}return e.prototype.getId=function(t){var n;if(!t)return-1;var r=(n=this.getMeta(t))===null||n===void 0?void 0:n.id;return r??-1},e.prototype.getNode=function(t){return this.idNodeMap.get(t)||null},e.prototype.getIds=function(){return Array.from(this.idNodeMap.keys())},e.prototype.getMeta=function(t){return this.nodeMetaMap.get(t)||null},e.prototype.removeNodeFromMap=function(t){var n=this,r=this.getId(t);this.idNodeMap.delete(r),t.childNodes&&t.childNodes.forEach(function(i){return n.removeNodeFromMap(i)})},e.prototype.has=function(t){return this.idNodeMap.has(t)},e.prototype.hasNode=function(t){return this.nodeMetaMap.has(t)},e.prototype.add=function(t,n){var r=n.id;this.idNodeMap.set(r,t),this.nodeMetaMap.set(t,n)},e.prototype.replace=function(t,n){var r=this.getNode(t);if(r){var i=this.nodeMetaMap.get(r);i&&this.nodeMetaMap.set(n,i)}this.idNodeMap.set(t,n)},e.prototype.reset=function(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap},e}();function Yt(){return new jt}function Ht(e){const t={},n=/;(?![^(]*\))/g,r=/:(.+)/,i=/\/\*.*?\*\//g;return e.replace(i,"").split(n).forEach(function(l){if(l){const o=l.split(r);o.length>1&&(t[we(o[0].trim())]=o[1].trim())}}),t}function Ve(e){const t=[];for(const n in e){const r=e[n];if(typeof r!="string")continue;const i=qt(n);t.push(`${i}: ${r};`)}return t.join(" ")}const zt=/-([a-z])/g,Xt=/^--[a-zA-Z0-9-]+$/,we=e=>Xt.test(e)?e:e.replace(zt,(t,n)=>n?n.toUpperCase():""),Qt=/\B([A-Z])/g,qt=e=>e.replace(Qt,"-$1").toLowerCase();class W{constructor(...t){this.childNodes=[],this.parentElement=null,this.parentNode=null,this.ELEMENT_NODE=O.ELEMENT_NODE,this.TEXT_NODE=O.TEXT_NODE}get firstChild(){return this.childNodes[0]||null}get lastChild(){return this.childNodes[this.childNodes.length-1]||null}get nextSibling(){const t=this.parentNode;if(!t)return null;const n=t.childNodes,r=n.indexOf(this);return n[r+1]||null}contains(t){if(t===this)return!0;for(const n of this.childNodes)if(n.contains(t))return!0;return!1}appendChild(t){throw new Error("RRDomException: Failed to execute 'appendChild' on 'RRNode': This RRNode type does not support this method.")}insertBefore(t,n){throw new Error("RRDomException: Failed to execute 'insertBefore' on 'RRNode': This RRNode type does not support this method.")}removeChild(t){throw new Error("RRDomException: Failed to execute 'removeChild' on 'RRNode': This RRNode type does not support this method.")}toString(){return"RRNode"}}function Jt(e){return class kt extends e{constructor(){super(...arguments),this.nodeType=O.DOCUMENT_NODE,this.nodeName="#document",this.compatMode="CSS1Compat",this.RRNodeType=S.Document,this.textContent=null}get documentElement(){return this.childNodes.find(n=>n.RRNodeType===S.Element&&n.tagName==="HTML")||null}get body(){var n;return((n=this.documentElement)===null||n===void 0?void 0:n.childNodes.find(r=>r.RRNodeType===S.Element&&r.tagName==="BODY"))||null}get head(){var n;return((n=this.documentElement)===null||n===void 0?void 0:n.childNodes.find(r=>r.RRNodeType===S.Element&&r.tagName==="HEAD"))||null}get implementation(){return this}get firstElementChild(){return this.documentElement}appendChild(n){const r=n.RRNodeType;if((r===S.Element||r===S.DocumentType)&&this.childNodes.some(i=>i.RRNodeType===r))throw new Error(`RRDomException: Failed to execute 'appendChild' on 'RRNode': Only one ${r===S.Element?"RRElement":"RRDoctype"} on RRDocument allowed.`);return n.parentElement=null,n.parentNode=this,this.childNodes.push(n),n}insertBefore(n,r){const i=n.RRNodeType;if((i===S.Element||i===S.DocumentType)&&this.childNodes.some(o=>o.RRNodeType===i))throw new Error(`RRDomException: Failed to execute 'insertBefore' on 'RRNode': Only one ${i===S.Element?"RRElement":"RRDoctype"} on RRDocument allowed.`);if(r===null)return this.appendChild(n);const l=this.childNodes.indexOf(r);if(l==-1)throw new Error("Failed to execute 'insertBefore' on 'RRNode': The RRNode before which the new node is to be inserted is not a child of this RRNode.");return this.childNodes.splice(l,0,n),n.parentElement=null,n.parentNode=this,n}removeChild(n){const r=this.childNodes.indexOf(n);if(r===-1)throw new Error("Failed to execute 'removeChild' on 'RRDocument': The RRNode to be removed is not a child of this RRNode.");return this.childNodes.splice(r,1),n.parentElement=null,n.parentNode=null,n}open(){this.childNodes=[]}close(){}write(n){let r;if(n==='<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "">'?r="-//W3C//DTD XHTML 1.0 Transitional//EN":n==='<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "">'&&(r="-//W3C//DTD HTML 4.0 Transitional//EN"),r){const i=this.createDocumentType("html",r,"");this.open(),this.appendChild(i)}}createDocument(n,r,i){return new kt}createDocumentType(n,r,i){const l=new(Ge(W))(n,r,i);return l.ownerDocument=this,l}createElement(n){const r=new(je(W))(n);return r.ownerDocument=this,r}createElementNS(n,r){return this.createElement(r)}createTextNode(n){const r=new(Ye(W))(n);return r.ownerDocument=this,r}createComment(n){const r=new(He(W))(n);return r.ownerDocument=this,r}createCDATASection(n){const r=new(ze(W))(n);return r.ownerDocument=this,r}toString(){return"RRDocument"}}}function Ge(e){return class extends e{constructor(t,n,r){super(),this.nodeType=O.DOCUMENT_TYPE_NODE,this.RRNodeType=S.DocumentType,this.textContent=null,this.name=t,this.publicId=n,this.systemId=r,this.nodeName=t}toString(){return"RRDocumentType"}}}function je(e){return class extends e{constructor(t){super(),this.nodeType=O.ELEMENT_NODE,this.RRNodeType=S.Element,this.attributes={},this.shadowRoot=null,this.tagName=t.toUpperCase(),this.nodeName=t.toUpperCase()}get textContent(){let t="";return this.childNodes.forEach(n=>t+=n.textContent),t}set textContent(t){this.childNodes=[this.ownerDocument.createTextNode(t)]}get classList(){return new Kt(this.attributes.class,t=>{this.attributes.class=t})}get id(){return this.attributes.id||""}get className(){return this.attributes.class||""}get style(){const t=this.attributes.style?Ht(this.attributes.style):{},n=/\B([A-Z])/g;return t.setProperty=(r,i,l)=>{if(n.test(r))return;const o=we(r);i?t[o]=i:delete t[o],l==="important"&&(t[o]+=" !important"),this.attributes.style=Ve(t)},t.removeProperty=r=>{if(n.test(r))return"";const i=we(r),l=t[i]||"";return delete t[i],this.attributes.style=Ve(t),l},t}getAttribute(t){return this.attributes[t]||null}setAttribute(t,n){this.attributes[t]=n}setAttributeNS(t,n,r){this.setAttribute(n,r)}removeAttribute(t){delete this.attributes[t]}appendChild(t){return this.childNodes.push(t),t.parentNode=this,t.parentElement=this,t}insertBefore(t,n){if(n===null)return this.appendChild(t);const r=this.childNodes.indexOf(n);if(r==-1)throw new Error("Failed to execute 'insertBefore' on 'RRNode': The RRNode before which the new node is to be inserted is not a child of this RRNode.");return this.childNodes.splice(r,0,t),t.parentElement=this,t.parentNode=this,t}removeChild(t){const n=this.childNodes.indexOf(t);if(n===-1)throw new Error("Failed to execute 'removeChild' on 'RRElement': The RRNode to be removed is not a child of this RRNode.");return this.childNodes.splice(n,1),t.parentElement=null,t.parentNode=null,t}attachShadow(t){const n=this.ownerDocument.createElement("SHADOWROOT");return this.shadowRoot=n,n}dispatchEvent(t){return!0}toString(){let t="";for(const n in this.attributes)t+=`${n}="${this.attributes[n]}" `;return`${this.tagName} ${t}`}}}function Zt(e){return class extends e{attachShadow(t){throw new Error("RRDomException: Failed to execute 'attachShadow' on 'RRElement': This RRElement does not support attachShadow")}play(){this.paused=!1}pause(){this.paused=!0}}}function Ye(e){return class extends e{constructor(t){super(),this.nodeType=O.TEXT_NODE,this.nodeName="#text",this.RRNodeType=S.Text,this.data=t}get textContent(){return this.data}set textContent(t){this.data=t}toString(){return`RRText text=${JSON.stringify(this.data)}`}}}function He(e){return class extends e{constructor(t){super(),this.nodeType=O.COMMENT_NODE,this.nodeName="#comment",this.RRNodeType=S.Comment,this.data=t}get textContent(){return this.data}set textContent(t){this.data=t}toString(){return`RRComment text=${JSON.stringify(this.data)}`}}}function ze(e){return class extends e{constructor(t){super(),this.nodeName="#cdata-section",this.nodeType=O.CDATA_SECTION_NODE,this.RRNodeType=S.CDATA,this.data=t}get textContent(){return this.data}set textContent(t){this.data=t}toString(){return`RRCDATASection data=${JSON.stringify(this.data)}`}}}class Kt{constructor(t,n){if(this.classes=[],this.add=(...r)=>{for(const i of r){const l=String(i);this.classes.indexOf(l)>=0||this.classes.push(l)}this.onChange&&this.onChange(this.classes.join(" "))},this.remove=(...r)=>{this.classes=this.classes.filter(i=>r.indexOf(i)===-1),this.onChange&&this.onChange(this.classes.join(" "))},t){const r=t.trim().split(/\s+/);this.classes.push(...r)}this.onChange=n}}var O;(function(e){e[e.PLACEHOLDER=0]="PLACEHOLDER",e[e.ELEMENT_NODE=1]="ELEMENT_NODE",e[e.ATTRIBUTE_NODE=2]="ATTRIBUTE_NODE",e[e.TEXT_NODE=3]="TEXT_NODE",e[e.CDATA_SECTION_NODE=4]="CDATA_SECTION_NODE",e[e.ENTITY_REFERENCE_NODE=5]="ENTITY_REFERENCE_NODE",e[e.ENTITY_NODE=6]="ENTITY_NODE",e[e.PROCESSING_INSTRUCTION_NODE=7]="PROCESSING_INSTRUCTION_NODE",e[e.COMMENT_NODE=8]="COMMENT_NODE",e[e.DOCUMENT_NODE=9]="DOCUMENT_NODE",e[e.DOCUMENT_TYPE_NODE=10]="DOCUMENT_TYPE_NODE",e[e.DOCUMENT_FRAGMENT_NODE=11]="DOCUMENT_FRAGMENT_NODE"})(O||(O={}));const Te={svg:"http://www.w3.org/2000/svg","xlink:href":"http://www.w3.org/1999/xlink",xmlns:"http://www.w3.org/2000/xmlns/"},en={altglyph:"altGlyph",altglyphdef:"altGlyphDef",altglyphitem:"altGlyphItem",animatecolor:"animateColor",animatemotion:"animateMotion",animatetransform:"animateTransform",clippath:"clipPath",feblend:"feBlend",fecolormatrix:"feColorMatrix",fecomponenttransfer:"feComponentTransfer",fecomposite:"feComposite",feconvolvematrix:"feConvolveMatrix",fediffuselighting:"feDiffuseLighting",fedisplacementmap:"feDisplacementMap",fedistantlight:"feDistantLight",fedropshadow:"feDropShadow",feflood:"feFlood",fefunca:"feFuncA",fefuncb:"feFuncB",fefuncg:"feFuncG",fefuncr:"feFuncR",fegaussianblur:"feGaussianBlur",feimage:"feImage",femerge:"feMerge",femergenode:"feMergeNode",femorphology:"feMorphology",feoffset:"feOffset",fepointlight:"fePointLight",fespecularlighting:"feSpecularLighting",fespotlight:"feSpotLight",fetile:"feTile",feturbulence:"feTurbulence",foreignobject:"foreignObject",glyphref:"glyphRef",lineargradient:"linearGradient",radialgradient:"radialGradient"};function j(e,t,n,r){const i=e.childNodes,l=t.childNodes;r=r||t.mirror||t.ownerDocument.mirror,(i.length>0||l.length>0)&&Xe(Array.from(i),l,e,n,r);let o=null,a=null;switch(t.RRNodeType){case S.Document:{a=t.scrollData;break}case S.Element:{const s=e,c=t;switch(tn(s,c,r),a=c.scrollData,o=c.inputData,c.tagName){case"AUDIO":case"VIDEO":{const u=e,d=c;d.paused!==void 0&&(d.paused?u.pause():u.play()),d.muted!==void 0&&(u.muted=d.muted),d.volume!==void 0&&(u.volume=d.volume),d.currentTime!==void 0&&(u.currentTime=d.currentTime),d.playbackRate!==void 0&&(u.playbackRate=d.playbackRate);break}case"CANVAS":{const u=t;if(u.rr_dataURL!==null){const d=document.createElement("img");d.onload=()=>{const m=s.getContext("2d");m&&m.drawImage(d,0,0,d.width,d.height)},d.src=u.rr_dataURL}u.canvasMutations.forEach(d=>n.applyCanvas(d.event,d.mutation,e))}break;case"STYLE":{const u=s.sheet;u&&t.rules.forEach(d=>n.applyStyleSheetMutation(d,u))}break}if(c.shadowRoot){s.shadowRoot||s.attachShadow({mode:"open"});const u=s.shadowRoot.childNodes,d=c.shadowRoot.childNodes;(u.length>0||d.length>0)&&Xe(Array.from(u),d,s.shadowRoot,n,r)}break}case S.Text:case S.Comment:case S.CDATA:e.textContent!==t.data&&(e.textContent=t.data);break}if(a&&n.applyScroll(a,!0),o&&n.applyInput(o),t.nodeName==="IFRAME"){const s=e.contentDocument,c=t;if(s){const u=r.getMeta(c.contentDocument);u&&n.mirror.add(s,Object.assign({},u)),j(s,c.contentDocument,n,r)}}}function tn(e,t,n){const r=e.attributes,i=t.attributes;for(const l in i){const o=i[l],a=n.getMeta(t);if(a&&"isSVG"in a&&a.isSVG&&Te[l])e.setAttributeNS(Te[l],l,o);else if(t.tagName==="CANVAS"&&l==="rr_dataURL"){const s=document.createElement("img");s.src=o,s.onload=()=>{const c=e.getContext("2d");c&&c.drawImage(s,0,0,s.width,s.height)}}else e.setAttribute(l,o)}for(const{name:l}of Array.from(r))l in i||e.removeAttribute(l);t.scrollLeft&&(e.scrollLeft=t.scrollLeft),t.scrollTop&&(e.scrollTop=t.scrollTop)}function Xe(e,t,n,r,i){var l;let o=0,a=e.length-1,s=0,c=t.length-1,u=e[o],d=e[a],m=t[s],f=t[c],N,E;for(;o<=a&&s<=c;){const y=r.mirror.getId(u),p=r.mirror.getId(d),v=i.getId(m),w=i.getId(f);if(u===void 0)u=e[++o];else if(d===void 0)d=e[--a];else if(y!==-1&&y===v)j(u,m,r,i),u=e[++o],m=t[++s];else if(p!==-1&&p===w)j(d,f,r,i),d=e[--a],f=t[--c];else if(y!==-1&&y===w)n.insertBefore(u,d.nextSibling),j(u,f,r,i),u=e[++o],f=t[--c];else if(p!==-1&&p===v)n.insertBefore(d,u),j(d,m,r,i),d=e[--a],m=t[++s];else{if(!N){N={};for(let T=o;T<=a;T++){const x=e[T];x&&r.mirror.hasNode(x)&&(N[r.mirror.getId(x)]=T)}}if(E=N[i.getId(m)],E){const T=e[E];n.insertBefore(T,u),j(T,m,r,i),e[E]=void 0}else{const T=Se(m,r.mirror,i);n.nodeName==="#document"&&((l=r.mirror.getMeta(T))===null||l===void 0?void 0:l.type)===S.Element&&n.documentElement&&(n.removeChild(n.documentElement),e[o]=void 0,u=void 0),n.insertBefore(T,u||null),j(T,m,r,i)}m=t[++s]}}if(o>a){const y=t[c+1];let p=null;for(y&&n.childNodes.forEach(v=>{r.mirror.getId(v)===i.getId(y)&&(p=v)});s<=c;++s){const v=Se(t[s],r.mirror,i);n.insertBefore(v,p),j(v,t[s],r,i)}}else if(s>c)for(;o<=a;o++){const y=e[o];y&&(n.removeChild(y),r.mirror.removeNodeFromMap(y))}}function Se(e,t,n){const r=n.getId(e),i=n.getMeta(e);let l=null;if(r>-1&&(l=t.getNode(r)),l!==null)return l;switch(e.RRNodeType){case S.Document:l=new Document;break;case S.DocumentType:l=document.implementation.createDocumentType(e.name,e.publicId,e.systemId);break;case S.Element:{let o=e.tagName.toLowerCase();o=en[o]||o,i&&"isSVG"in i&&i?.isSVG?l=document.createElementNS(Te.svg,o):l=document.createElement(e.tagName);break}case S.Text:l=document.createTextNode(e.data);break;case S.Comment:l=document.createComment(e.data);break;case S.CDATA:l=document.createCDATASection(e.data);break}return i&&t.add(l,Object.assign({},i)),l}class ee extends Jt(W){constructor(t){super(),this.UNSERIALIZED_STARTING_ID=-2,this._unserializedId=this.UNSERIALIZED_STARTING_ID,this.mirror=pn(),this.scrollData=null,t&&(this.mirror=t)}get unserializedId(){return this._unserializedId--}createDocument(t,n,r){return new ee}createDocumentType(t,n,r){const i=new nn(t,n,r);return i.ownerDocument=this,i}createElement(t){const n=t.toUpperCase();let r;switch(n){case"AUDIO":case"VIDEO":r=new rn(n);break;case"IFRAME":r=new an(n,this.mirror);break;case"CANVAS":r=new on(n);break;case"STYLE":r=new sn(n);break;default:r=new se(n);break}return r.ownerDocument=this,r}createComment(t){const n=new cn(t);return n.ownerDocument=this,n}createCDATASection(t){const n=new un(t);return n.ownerDocument=this,n}createTextNode(t){const n=new ln(t);return n.ownerDocument=this,n}destroyTree(){this.childNodes=[],this.mirror.reset()}open(){super.open(),this._unserializedId=this.UNSERIALIZED_STARTING_ID}}const nn=Ge(W);class se extends je(W){constructor(){super(...arguments),this.inputData=null,this.scrollData=null}}class rn extends Zt(se){}class on extends se{constructor(){super(...arguments),this.rr_dataURL=null,this.canvasMutations=[]}getContext(){return null}}class sn extends se{constructor(){super(...arguments),this.rules=[]}}class an extends se{constructor(t,n){super(t),this.contentDocument=new ee,this.contentDocument.mirror=n}}const ln=Ye(W),cn=He(W),un=ze(W);function dn(e){return e instanceof HTMLFormElement?"FORM":e.tagName.toUpperCase()}function Qe(e,t,n,r){let i;switch(e.nodeType){case O.DOCUMENT_NODE:r&&r.nodeName==="IFRAME"?i=r.contentDocument:(i=t,i.compatMode=e.compatMode);break;case O.DOCUMENT_TYPE_NODE:{const o=e;i=t.createDocumentType(o.name,o.publicId,o.systemId);break}case O.ELEMENT_NODE:{const o=e,a=dn(o);i=t.createElement(a);const s=i;for(const{name:c,value:u}of Array.from(o.attributes))s.attributes[c]=u;o.scrollLeft&&(s.scrollLeft=o.scrollLeft),o.scrollTop&&(s.scrollTop=o.scrollTop);break}case O.TEXT_NODE:i=t.createTextNode(e.textContent||"");break;case O.CDATA_SECTION_NODE:i=t.createCDATASection(e.data);break;case O.COMMENT_NODE:i=t.createComment(e.textContent||"");break;case O.DOCUMENT_FRAGMENT_NODE:i=r.attachShadow({mode:"open"});break;default:return null}let l=n.getMeta(e);return t instanceof ee&&(l||(l=qe(i,t.unserializedId),n.add(e,l)),t.mirror.add(i,Object.assign({},l))),i}function hn(e,t=Yt(),n=new ee){function r(i,l){const o=Qe(i,n,t,l);if(o!==null)if(l?.nodeName!=="IFRAME"&&i.nodeType!==O.DOCUMENT_FRAGMENT_NODE&&(l?.appendChild(o),o.parentNode=l,o.parentElement=l),i.nodeName==="IFRAME"){const a=i.contentDocument;a&&r(a,o)}else(i.nodeType===O.DOCUMENT_NODE||i.nodeType===O.ELEMENT_NODE||i.nodeType===O.DOCUMENT_FRAGMENT_NODE)&&(i.nodeType===O.ELEMENT_NODE&&i.shadowRoot&&r(i.shadowRoot,o),i.childNodes.forEach(a=>r(a,o)))}return r(e,null),n}function pn(){return new mn}class mn{constructor(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}getId(t){var n;if(!t)return-1;const r=(n=this.getMeta(t))===null||n===void 0?void 0:n.id;return r??-1}getNode(t){return this.idNodeMap.get(t)||null}getIds(){return Array.from(this.idNodeMap.keys())}getMeta(t){return this.nodeMetaMap.get(t)||null}removeNodeFromMap(t){const n=this.getId(t);this.idNodeMap.delete(n),t.childNodes&&t.childNodes.forEach(r=>this.removeNodeFromMap(r))}has(t){return this.idNodeMap.has(t)}hasNode(t){return this.nodeMetaMap.has(t)}add(t,n){const r=n.id;this.idNodeMap.set(r,t),this.nodeMetaMap.set(t,n)}replace(t,n){const r=this.getNode(t);if(r){const i=this.nodeMetaMap.get(r);i&&this.nodeMetaMap.set(n,i)}this.idNodeMap.set(t,n)}reset(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}}function qe(e,t){switch(e.RRNodeType){case S.Document:return{id:t,type:e.RRNodeType,childNodes:[]};case S.DocumentType:{const n=e;return{id:t,type:e.RRNodeType,name:n.name,publicId:n.publicId,systemId:n.systemId}}case S.Element:return{id:t,type:e.RRNodeType,tagName:e.tagName.toLowerCase(),attributes:{},childNodes:[]};case S.Text:return{id:t,type:e.RRNodeType,textContent:e.textContent||""};case S.Comment:return{id:t,type:e.RRNodeType,textContent:e.textContent||""};case S.CDATA:return{id:t,type:e.RRNodeType,textContent:""}}}function Je(e){return{all:e=e||new Map,on:function(t,n){var r=e.get(t);r?r.push(n):e.set(t,[n])},off:function(t,n){var r=e.get(t);r&&(n?r.splice(r.indexOf(n)>>>0,1):e.set(t,[]))},emit:function(t,n){var r=e.get(t);r&&r.slice().map(function(i){i(n)}),(r=e.get("*"))&&r.slice().map(function(i){i(t,n)})}}}var fn=Object.freeze({__proto__:null,default:Je});function gn(e=window,t=document){if("scrollBehavior"in t.documentElement.style&&e.__forceSmoothScrollPolyfill__!==!0)return;const n=e.HTMLElement||e.Element,r=468,i={scroll:e.scroll||e.scrollTo,scrollBy:e.scrollBy,elementScroll:n.prototype.scroll||s,scrollIntoView:n.prototype.scrollIntoView},l=e.performance&&e.performance.now?e.performance.now.bind(e.performance):Date.now;function o(p){const v=["MSIE ","Trident/","Edge/"];return new RegExp(v.join("|")).test(p)}const a=o(e.navigator.userAgent)?1:0;function s(p,v){this.scrollLeft=p,this.scrollTop=v}function c(p){return .5*(1-Math.cos(Math.PI*p))}function u(p){if(p===null||typeof p!="object"||p.behavior===void 0||p.behavior==="auto"||p.behavior==="instant")return!0;if(typeof p=="object"&&p.behavior==="smooth")return!1;throw new TypeError("behavior member of ScrollOptions "+p.behavior+" is not a valid value for enumeration ScrollBehavior.")}function d(p,v){if(v==="Y")return p.clientHeight+a<p.scrollHeight;if(v==="X")return p.clientWidth+a<p.scrollWidth}function m(p,v){const w=e.getComputedStyle(p,null)["overflow"+v];return w==="auto"||w==="scroll"}function f(p){const v=d(p,"Y")&&m(p,"Y"),w=d(p,"X")&&m(p,"X");return v||w}function N(p){for(;p!==t.body&&f(p)===!1;)p=p.parentNode||p.host;return p}function E(p){const v=l();let w,T,x,A=(v-p.startTime)/r;A=A>1?1:A,w=c(A),T=p.startX+(p.x-p.startX)*w,x=p.startY+(p.y-p.startY)*w,p.method.call(p.scrollable,T,x),(T!==p.x||x!==p.y)&&e.requestAnimationFrame(E.bind(e,p))}function y(p,v,w){let T,x,A,$;const L=l();p===t.body?(T=e,x=e.scrollX||e.pageXOffset,A=e.scrollY||e.pageYOffset,$=i.scroll):(T=p,x=p.scrollLeft,A=p.scrollTop,$=s),E({scrollable:T,method:$,startTime:L,startX:x,startY:A,x:v,y:w})}e.scroll=e.scrollTo=function(){if(arguments[0]!==void 0){if(u(arguments[0])===!0){i.scroll.call(e,arguments[0].left!==void 0?arguments[0].left:typeof arguments[0]!="object"?arguments[0]:e.scrollX||e.pageXOffset,arguments[0].top!==void 0?arguments[0].top:arguments[1]!==void 0?arguments[1]:e.scrollY||e.pageYOffset);return}y.call(e,t.body,arguments[0].left!==void 0?~~arguments[0].left:e.scrollX||e.pageXOffset,arguments[0].top!==void 0?~~arguments[0].top:e.scrollY||e.pageYOffset)}},e.scrollBy=function(){if(arguments[0]!==void 0){if(u(arguments[0])){i.scrollBy.call(e,arguments[0].left!==void 0?arguments[0].left:typeof arguments[0]!="object"?arguments[0]:0,arguments[0].top!==void 0?arguments[0].top:arguments[1]!==void 0?arguments[1]:0);return}y.call(e,t.body,~~arguments[0].left+(e.scrollX||e.pageXOffset),~~arguments[0].top+(e.scrollY||e.pageYOffset))}},n.prototype.scroll=n.prototype.scrollTo=function(){if(arguments[0]===void 0)return;if(u(arguments[0])===!0){if(typeof arguments[0]=="number"&&arguments[1]===void 0)throw new SyntaxError("Value could not be converted");i.elementScroll.call(this,arguments[0].left!==void 0?~~arguments[0].left:typeof arguments[0]!="object"?~~arguments[0]:this.scrollLeft,arguments[0].top!==void 0?~~arguments[0].top:arguments[1]!==void 0?~~arguments[1]:this.scrollTop);return}const p=arguments[0].left,v=arguments[0].top;y.call(this,this,typeof p>"u"?this.scrollLeft:~~p,typeof v>"u"?this.scrollTop:~~v)},n.prototype.scrollBy=function(){if(arguments[0]!==void 0){if(u(arguments[0])===!0){i.elementScroll.call(this,arguments[0].left!==void 0?~~arguments[0].left+this.scrollLeft:~~arguments[0]+this.scrollLeft,arguments[0].top!==void 0?~~arguments[0].top+this.scrollTop:~~arguments[1]+this.scrollTop);return}this.scroll({left:~~arguments[0].left+this.scrollLeft,top:~~arguments[0].top+this.scrollTop,behavior:arguments[0].behavior})}},n.prototype.scrollIntoView=function(){if(u(arguments[0])===!0){i.scrollIntoView.call(this,arguments[0]===void 0?!0:arguments[0]);return}const p=N(this),v=p.getBoundingClientRect(),w=this.getBoundingClientRect();p!==t.body?(y.call(this,p,p.scrollLeft+w.left-v.left,p.scrollTop+w.top-v.top),e.getComputedStyle(p).position!=="fixed"&&e.scrollBy({left:v.left,top:v.top,behavior:"smooth"})):e.scrollBy({left:w.left,top:w.top,behavior:"smooth"})}}var I=(e=>(e[e.DomContentLoaded=0]="DomContentLoaded",e[e.Load=1]="Load",e[e.FullSnapshot=2]="FullSnapshot",e[e.IncrementalSnapshot=3]="IncrementalSnapshot",e[e.Meta=4]="Meta",e[e.Custom=5]="Custom",e[e.Plugin=6]="Plugin",e))(I||{}),D=(e=>(e[e.Mutation=0]="Mutation",e[e.MouseMove=1]="MouseMove",e[e.MouseInteraction=2]="MouseInteraction",e[e.Scroll=3]="Scroll",e[e.ViewportResize=4]="ViewportResize",e[e.Input=5]="Input",e[e.TouchMove=6]="TouchMove",e[e.MediaInteraction=7]="MediaInteraction",e[e.StyleSheetRule=8]="StyleSheetRule",e[e.CanvasMutation=9]="CanvasMutation",e[e.Font=10]="Font",e[e.Log=11]="Log",e[e.Drag=12]="Drag",e[e.StyleDeclaration=13]="StyleDeclaration",e[e.Selection=14]="Selection",e[e.AdoptedStyleSheet=15]="AdoptedStyleSheet",e))(D||{}),P=(e=>(e[e.MouseUp=0]="MouseUp",e[e.MouseDown=1]="MouseDown",e[e.Click=2]="Click",e[e.ContextMenu=3]="ContextMenu",e[e.DblClick=4]="DblClick",e[e.Focus=5]="Focus",e[e.Blur=6]="Blur",e[e.TouchStart=7]="TouchStart",e[e.TouchMove_Departed=8]="TouchMove_Departed",e[e.TouchEnd=9]="TouchEnd",e[e.TouchCancel=10]="TouchCancel",e))(P||{}),me=(e=>(e[e["2D"]=0]="2D",e[e.WebGL=1]="WebGL",e[e.WebGL2=2]="WebGL2",e))(me||{}),fe=(e=>(e[e.Play=0]="Play",e[e.Pause=1]="Pause",e[e.Seeked=2]="Seeked",e[e.VolumeChange=3]="VolumeChange",e[e.RateChange=4]="RateChange",e))(fe||{}),M=(e=>(e.Start="start",e.Pause="pause",e.Resume="resume",e.Resize="resize",e.Finish="finish",e.FullsnapshotRebuilded="fullsnapshot-rebuilded",e.LoadStylesheetStart="load-stylesheet-start",e.LoadStylesheetEnd="load-stylesheet-end",e.SkipStart="skip-start",e.SkipEnd="skip-end",e.MouseInteraction="mouse-interaction",e.EventCast="event-cast",e.CustomEvent="custom-event",e.Flush="flush",e.StateChange="state-change",e.PlayBack="play-back",e.Destroy="destroy",e))(M||{});class yn{constructor(t=[],n){this.timeOffset=0,this.raf=null,this.actions=t,this.speed=n.speed,this.liveMode=n.liveMode}addAction(t){if(!this.actions.length||this.actions[this.actions.length-1].delay<=t.delay){this.actions.push(t);return}const n=this.findActionIndex(t);this.actions.splice(n,0,t)}start(){this.timeOffset=0;let t=performance.now();const n=()=>{const r=performance.now();for(this.timeOffset+=(r-t)*this.speed,t=r;this.actions.length;){const i=this.actions[0];if(this.timeOffset>=i.delay)this.actions.shift(),i.doAction();else break}(this.actions.length>0||this.liveMode)&&(this.raf=requestAnimationFrame(n))};this.raf=requestAnimationFrame(n)}clear(){this.raf&&(cancelAnimationFrame(this.raf),this.raf=null),this.actions.length=0}setSpeed(t){this.speed=t}toggleLiveMode(t){this.liveMode=t}isActive(){return this.raf!==null}findActionIndex(t){let n=0,r=this.actions.length-1;for(;n<=r;){const i=Math.floor((n+r)/2);if(this.actions[i].delay<t.delay)n=i+1;else if(this.actions[i].delay>t.delay)r=i-1;else return i+1}return n}}function Ze(e,t){if(e.type===I.IncrementalSnapshot&&e.data.source===D.MouseMove&&e.data.positions&&e.data.positions.length){const n=e.data.positions[0].timeOffset,r=e.timestamp+n;return e.delay=r-t,r-t}return e.delay=e.timestamp-t,e.delay}/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */function Ke(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r,i,l=n.call(e),o=[];try{for(;(t===void 0||t-- >0)&&!(r=l.next()).done;)o.push(r.value)}catch(a){i={error:a}}finally{try{r&&!r.done&&(n=l.return)&&n.call(l)}finally{if(i)throw i.error}}return o}var te;(function(e){e[e.NotStarted=0]="NotStarted",e[e.Running=1]="Running",e[e.Stopped=2]="Stopped"})(te||(te={}));var et={type:"xstate.init"};function be(e){return e===void 0?[]:[].concat(e)}function ne(e){return{type:"xstate.assign",assignment:e}}function tt(e,t){return typeof(e=typeof e=="string"&&t&&t[e]?t[e]:e)=="string"?{type:e}:typeof e=="function"?{type:e.name,exec:e}:e}function ge(e){return function(t){return e===t}}function nt(e){return typeof e=="string"?{type:e}:e}function rt(e,t){return{value:e,context:t,actions:[],changed:!1,matches:ge(e)}}function ot(e,t,n){var r=t,i=!1;return[e.filter(function(l){if(l.type==="xstate.assign"){i=!0;var o=Object.assign({},r);return typeof l.assignment=="function"?o=l.assignment(r,n):Object.keys(l.assignment).forEach(function(a){o[a]=typeof l.assignment[a]=="function"?l.assignment[a](r,n):l.assignment[a]}),r=o,!1}return!0}),r,i]}function it(e,t){t===void 0&&(t={});var n=Ke(ot(be(e.states[e.initial].entry).map(function(o){return tt(o,t.actions)}),e.context,et),2),r=n[0],i=n[1],l={config:e,_options:t,initialState:{value:e.initial,actions:r,context:i,matches:ge(e.initial)},transition:function(o,a){var s,c,u=typeof o=="string"?{value:o,context:e.context}:o,d=u.value,m=u.context,f=nt(a),N=e.states[d];if(N.on){var E=be(N.on[f.type]);try{for(var y=function(k){var K=typeof Symbol=="function"&&Symbol.iterator,g=K&&k[K],h=0;if(g)return g.call(k);if(k&&typeof k.length=="number")return{next:function(){return k&&h>=k.length&&(k=void 0),{value:k&&k[h++],done:!k}}};throw new TypeError(K?"Object is not iterable.":"Symbol.iterator is not defined.")}(E),p=y.next();!p.done;p=y.next()){var v=p.value;if(v===void 0)return rt(d,m);var w=typeof v=="string"?{target:v}:v,T=w.target,x=w.actions,A=x===void 0?[]:x,$=w.cond,L=$===void 0?function(){return!0}:$,Z=T===void 0,de=T??d,he=e.states[de];if(L(m,f)){var Q=Ke(ot((Z?be(A):[].concat(N.exit,A,he.entry).filter(function(k){return k})).map(function(k){return tt(k,l._options.actions)}),m,f),3),G=Q[0],q=Q[1],oe=Q[2],B=T??d;return{value:B,context:q,actions:G,changed:T!==d||G.length>0||oe,matches:ge(B)}}}}catch(k){s={error:k}}finally{try{p&&!p.done&&(c=y.return)&&c.call(y)}finally{if(s)throw s.error}}}return rt(d,m)}};return l}var st=function(e,t){return e.actions.forEach(function(n){var r=n.exec;return r&&r(e.context,t)})};function at(e){var t=e.initialState,n=te.NotStarted,r=new Set,i={_machine:e,send:function(l){n===te.Running&&(t=e.transition(t,l),st(t,nt(l)),r.forEach(function(o){return o(t)}))},subscribe:function(l){return r.add(l),l(t),{unsubscribe:function(){return r.delete(l)}}},start:function(l){if(l){var o=typeof l=="object"?l:{context:e.config.context,value:l};t={value:o.value,actions:[],context:o.context,matches:ge(o.value)}}return n=te.Running,st(t,et),i},stop:function(){return n=te.Stopped,r.clear(),i},get state(){return t},get status(){return n}};return i}var vn=Object.defineProperty,Nn=Object.defineProperties,En=Object.getOwnPropertyDescriptors,lt=Object.getOwnPropertySymbols,wn=Object.prototype.hasOwnProperty,Tn=Object.prototype.propertyIsEnumerable,ct=(e,t,n)=>t in e?vn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,De=(e,t)=>{for(var n in t||(t={}))wn.call(t,n)&&ct(e,n,t[n]);if(lt)for(var n of lt(t))Tn.call(t,n)&&ct(e,n,t[n]);return e},Me=(e,t)=>Nn(e,En(t));function Sn(e,t){for(let n=e.length-1;n>=0;n--){const r=e[n];if(r.type===I.Meta&&r.timestamp<=t)return e.slice(n)}return e}function bn(e,{getCastFn:t,applyEventsSynchronously:n,emitter:r}){const i=it({id:"player",context:e,initial:"paused",states:{playing:{on:{PAUSE:{target:"paused",actions:["pause"]},CAST_EVENT:{target:"playing",actions:"castEvent"},END:{target:"paused",actions:["resetLastPlayedEvent","pause"]},ADD_EVENT:{target:"playing",actions:["addEvent"]}}},paused:{on:{PLAY:{target:"playing",actions:["recordTimeOffset","play"]},CAST_EVENT:{target:"paused",actions:"castEvent"},TO_LIVE:{target:"live",actions:["startLive"]},ADD_EVENT:{target:"paused",actions:["addEvent"]}}},live:{on:{ADD_EVENT:{target:"live",actions:["addEvent"]},CAST_EVENT:{target:"live",actions:["castEvent"]}}}}},{actions:{castEvent:ne({lastPlayedEvent:(l,o)=>o.type==="CAST_EVENT"?o.payload.event:l.lastPlayedEvent}),recordTimeOffset:ne((l,o)=>{let a=l.timeOffset;return"payload"in o&&"timeOffset"in o.payload&&(a=o.payload.timeOffset),Me(De({},l),{timeOffset:a,baselineTime:l.events[0].timestamp+a})}),play(l){var o;const{timer:a,events:s,baselineTime:c,lastPlayedEvent:u}=l;a.clear();for(const N of s)Ze(N,c);const d=Sn(s,c);let m=u?.timestamp;u?.type===I.IncrementalSnapshot&&u.data.source===D.MouseMove&&(m=u.timestamp+((o=u.data.positions[0])==null?void 0:o.timeOffset)),c<(m||0)&&r.emit(M.PlayBack);const f=new Array;for(const N of d)if(!(m&&m<c&&(N.timestamp<=m||N===u)))if(N.timestamp<c)f.push(N);else{const E=t(N,!1);a.addAction({doAction:()=>{E()},delay:N.delay})}n(f),r.emit(M.Flush),a.start()},pause(l){l.timer.clear()},resetLastPlayedEvent:ne(l=>Me(De({},l),{lastPlayedEvent:null})),startLive:ne({baselineTime:(l,o)=>(l.timer.toggleLiveMode(!0),l.timer.start(),o.type==="TO_LIVE"&&o.payload.baselineTime?o.payload.baselineTime:Date.now())}),addEvent:ne((l,o)=>{const{baselineTime:a,timer:s,events:c}=l;if(o.type==="ADD_EVENT"){const{event:u}=o.payload;Ze(u,a);let d=c.length-1;if(!c[d]||c[d].timestamp<=u.timestamp)c.push(u);else{let N=-1,E=0;for(;E<=d;){const y=Math.floor((E+d)/2);c[y].timestamp<=u.timestamp?E=y+1:d=y-1}N===-1&&(N=E),c.splice(N,0,u)}const m=u.timestamp<a,f=t(u,m);m?f():s.isActive()&&s.addAction({doAction:()=>{f()},delay:u.delay})}return Me(De({},l),{events:c})})}});return at(i)}function Dn(e){const t=it({id:"speed",context:e,initial:"normal",states:{normal:{on:{FAST_FORWARD:{target:"skipping",actions:["recordSpeed","setSpeed"]},SET_SPEED:{target:"normal",actions:["setSpeed"]}}},skipping:{on:{BACK_TO_NORMAL:{target:"normal",actions:["restoreSpeed"]},SET_SPEED:{target:"normal",actions:["setSpeed"]}}}}},{actions:{setSpeed:(n,r)=>{"payload"in r&&n.timer.setSpeed(r.payload.speed)},recordSpeed:ne({normalSpeed:n=>n.timer.speed}),restoreSpeed:n=>{n.timer.setSpeed(n.normalSpeed)}}});return at(t)}const re=`Please stop import mirror directly. Instead of that,\r
now you can use replayer.getMirror() to access the mirror instance of a replayer,\r
or you can use record.mirror to access the mirror instance during recording.`;let ut={map:{},getId(){return console.error(re),-1},getNode(){return console.error(re),null},removeNodeFromMap(){console.error(re)},has(){return console.error(re),!1},reset(){console.error(re)}};typeof window<"u"&&window.Proxy&&window.Reflect&&(ut=new Proxy(ut,{get(e,t,n){return t==="map"&&console.error(re),Reflect.get(e,t,n)}}));function Mn(e=window){"NodeList"in e&&!e.NodeList.prototype.forEach&&(e.NodeList.prototype.forEach=Array.prototype.forEach),"DOMTokenList"in e&&!e.DOMTokenList.prototype.forEach&&(e.DOMTokenList.prototype.forEach=Array.prototype.forEach),Node.prototype.contains||(Node.prototype.contains=(...t)=>{let n=t[0];if(!(0 in t))throw new TypeError("1 argument is required");do if(this===n)return!0;while(n=n&&n.parentNode);return!1})}function Cn(e){const t={},n=(i,l)=>{const o={value:i,parent:l,children:[]};return t[i.node.id]=o,o},r=[];for(const i of e){const{nextId:l,parentId:o}=i;if(l&&l in t){const a=t[l];if(a.parent){const s=a.parent.children.indexOf(a);a.parent.children.splice(s,0,n(i,a.parent))}else{const s=r.indexOf(a);r.splice(s,0,n(i,null))}continue}if(o in t){const a=t[o];a.children.push(n(i,a));continue}r.push(n(i,null))}return r}function dt(e,t){t(e.value);for(let n=e.children.length-1;n>=0;n--)dt(e.children[n],t)}function Ce(e,t){return Boolean(e.nodeName==="IFRAME"&&t.getMeta(e))}function ht(e,t){var n,r;const i=(r=(n=e.ownerDocument)==null?void 0:n.defaultView)==null?void 0:r.frameElement;if(!i||i===t)return{x:0,y:0,relativeScale:1,absoluteScale:1};const l=i.getBoundingClientRect(),o=ht(i,t),a=l.height/i.clientHeight;return{x:l.x*o.relativeScale+o.x,y:l.y*o.relativeScale+o.y,relativeScale:a,absoluteScale:o.absoluteScale*a}}function ye(e){return Boolean(e?.shadowRoot)}function ae(e,t){const n=e[t[0]];return t.length===1?n:ae(n.cssRules[t[1]].cssRules,t.slice(2))}function pt(e){const t=[...e],n=t.pop();return{positions:t,index:n}}function Rn(e){const t=new Set,n=[];for(let r=e.length;r--;){const i=e[r];t.has(i.id)||(n.push(i),t.add(i.id))}return n}class xn{constructor(){this.id=1,this.styleIDMap=new WeakMap,this.idStyleMap=new Map}getId(t){var n;return(n=this.styleIDMap.get(t))!=null?n:-1}has(t){return this.styleIDMap.has(t)}add(t,n){if(this.has(t))return this.getId(t);let r;return n===void 0?r=this.id++:r=n,this.styleIDMap.set(t,r),this.idStyleMap.set(r,t),r}getStyle(t){return this.idStyleMap.get(t)||null}reset(){this.styleIDMap=new WeakMap,this.idStyleMap=new Map,this.id=1}generateId(){return this.id++}}const An=e=>[`.${e} { background: currentColor }`,"noscript { display: none !important; }"];for(var mt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",le=typeof Uint8Array>"u"?[]:new Uint8Array(256),ve=0;ve<mt.length;ve++)le[mt.charCodeAt(ve)]=ve;var In=function(e){var t=e.length*.75,n=e.length,r,i=0,l,o,a,s;e[e.length-1]==="="&&(t--,e[e.length-2]==="="&&t--);var c=new ArrayBuffer(t),u=new Uint8Array(c);for(r=0;r<n;r+=4)l=le[e.charCodeAt(r)],o=le[e.charCodeAt(r+1)],a=le[e.charCodeAt(r+2)],s=le[e.charCodeAt(r+3)],u[i++]=l<<2|o>>4,u[i++]=(o&15)<<4|a>>2,u[i++]=(a&3)<<6|s&63;return c},On=(e,t,n)=>new Promise((r,i)=>{var l=s=>{try{a(n.next(s))}catch(c){i(c)}},o=s=>{try{a(n.throw(s))}catch(c){i(c)}},a=s=>s.done?r(s.value):Promise.resolve(s.value).then(l,o);a((n=n.apply(e,t)).next())});const ft=new Map;function gt(e,t){let n=ft.get(e);return n||(n=new Map,ft.set(e,n)),n.has(t)||n.set(t,[]),n.get(t)}function H(e,t,n){return r=>On(this,null,function*(){if(r&&typeof r=="object"&&"rr_type"in r)if(n&&(n.isUnchanged=!1),r.rr_type==="ImageBitmap"&&"args"in r){const i=yield H(e,t,n)(r.args);return yield createImageBitmap.apply(null,i)}else if("index"in r){if(n||t===null)return r;const{rr_type:i,index:l}=r;return gt(t,i)[l]}else if("args"in r){const{rr_type:i,args:l}=r,o=window[i];return new o(...yield Promise.all(l.map(H(e,t,n))))}else{if("base64"in r)return In(r.base64);if("src"in r){const i=e.get(r.src);if(i)return i;{const l=new Image;return l.src=r.src,e.set(r.src,l),l}}else if("data"in r&&r.rr_type==="Blob"){const i=yield Promise.all(r.data.map(H(e,t,n)));return new Blob(i,{type:r.type})}}else if(Array.isArray(r))return yield Promise.all(r.map(H(e,t,n)));return r})}var kn=(e,t,n)=>new Promise((r,i)=>{var l=s=>{try{a(n.next(s))}catch(c){i(c)}},o=s=>{try{a(n.throw(s))}catch(c){i(c)}},a=s=>s.done?r(s.value):Promise.resolve(s.value).then(l,o);a((n=n.apply(e,t)).next())});function _n(e,t){try{return t===me.WebGL?e.getContext("webgl")||e.getContext("experimental-webgl"):e.getContext("webgl2")}catch{return null}}const Ln=["WebGLActiveInfo","WebGLBuffer","WebGLFramebuffer","WebGLProgram","WebGLRenderbuffer","WebGLShader","WebGLShaderPrecisionFormat","WebGLTexture","WebGLUniformLocation","WebGLVertexArrayObject"];function Fn(e,t){if(!(t!=null&&t.constructor))return;const{name:n}=t.constructor;if(!Ln.includes(n))return;const r=gt(e,n);r.includes(t)||r.push(t)}function Pn(e){return kn(this,arguments,function*({mutation:t,target:n,type:r,imageMap:i,errorHandler:l}){try{const o=_n(n,r);if(!o)return;if(t.setter){o[t.property]=t.args[0];return}const a=o[t.property],s=yield Promise.all(t.args.map(H(i,o))),c=a.apply(o,s);Fn(o,c)}catch(o){l(t,o)}})}var Bn=(e,t,n)=>new Promise((r,i)=>{var l=s=>{try{a(n.next(s))}catch(c){i(c)}},o=s=>{try{a(n.throw(s))}catch(c){i(c)}},a=s=>s.done?r(s.value):Promise.resolve(s.value).then(l,o);a((n=n.apply(e,t)).next())});function Un(e){return Bn(this,arguments,function*({event:t,mutation:n,target:r,imageMap:i,errorHandler:l}){try{const o=r.getContext("2d");if(n.setter){o[n.property]=n.args[0];return}const a=o[n.property];if(n.property==="drawImage"&&typeof n.args[0]=="string")i.get(t),a.apply(o,n.args);else{const s=yield Promise.all(n.args.map(H(i,o)));a.apply(o,s)}}catch(o){l(n,o)}})}var $n=(e,t,n)=>new Promise((r,i)=>{var l=s=>{try{a(n.next(s))}catch(c){i(c)}},o=s=>{try{a(n.throw(s))}catch(c){i(c)}},a=s=>s.done?r(s.value):Promise.resolve(s.value).then(l,o);a((n=n.apply(e,t)).next())});function yt(e){return $n(this,arguments,function*({event:t,mutation:n,target:r,imageMap:i,canvasEventMap:l,errorHandler:o}){try{const a=l.get(t)||n,s="commands"in a?a.commands:[a];if([me.WebGL,me.WebGL2].includes(n.type)){for(let c=0;c<s.length;c++){const u=s[c];yield Pn({mutation:u,type:n.type,target:r,imageMap:i,errorHandler:o})}return}for(let c=0;c<s.length;c++){const u=s[c];yield Un({event:t,mutation:u,target:r,imageMap:i,errorHandler:o})}}catch(a){o(n,a)}})}var Wn=Object.defineProperty,Vn=Object.defineProperties,Gn=Object.getOwnPropertyDescriptors,vt=Object.getOwnPropertySymbols,jn=Object.prototype.hasOwnProperty,Yn=Object.prototype.propertyIsEnumerable,Nt=(e,t,n)=>t in e?Wn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Ne=(e,t)=>{for(var n in t||(t={}))jn.call(t,n)&&Nt(e,n,t[n]);if(vt)for(var n of vt(t))Yn.call(t,n)&&Nt(e,n,t[n]);return e},Re=(e,t)=>Vn(e,Gn(t)),xe=(e,t,n)=>new Promise((r,i)=>{var l=s=>{try{a(n.next(s))}catch(c){i(c)}},o=s=>{try{a(n.throw(s))}catch(c){i(c)}},a=s=>s.done?r(s.value):Promise.resolve(s.value).then(l,o);a((n=n.apply(e,t)).next())});const Hn=10*1e3,zn=5*1e3,Xn=Je||fn,Ae="[replayer]",Ie={duration:500,lineCap:"round",lineWidth:3,strokeStyle:"red"};function Et(e){return e.type==I.IncrementalSnapshot&&(e.data.source==D.TouchMove||e.data.source==D.MouseInteraction&&e.data.type==P.TouchStart)}class Qn{constructor(t,n){if(this.usingVirtualDom=!1,this.virtualDom=new ee,this.mouseTail=null,this.tailPositions=[],this.emitter=Xn(),this.legacy_missingNodeRetryMap={},this.cache=We(),this.imageMap=new Map,this.canvasEventMap=new Map,this.mirror=Lt(),this.styleMirror=new xn,this.firstFullSnapshot=null,this.newDocumentQueue=[],this.mousePos=null,this.touchActive=null,this.lastSelectionData=null,this.constructedStyleMutations=[],this.adoptedStyleSheets=[],this.handleResize=a=>{this.iframe.style.display="inherit";for(const s of[this.mouseTail,this.iframe])!s||(s.setAttribute("width",String(a.width)),s.setAttribute("height",String(a.height)))},this.applyEventsSynchronously=a=>{for(const s of a){switch(s.type){case I.DomContentLoaded:case I.Load:case I.Custom:continue;case I.FullSnapshot:case I.Meta:case I.Plugin:case I.IncrementalSnapshot:break}this.getCastFn(s,!0)()}this.touchActive===!0?this.mouse.classList.add("touch-active"):this.touchActive===!1&&this.mouse.classList.remove("touch-active"),this.touchActive=null},this.getCastFn=(a,s=!1)=>{let c;switch(a.type){case I.DomContentLoaded:case I.Load:break;case I.Custom:c=()=>{this.emitter.emit(M.CustomEvent,a)};break;case I.Meta:c=()=>this.emitter.emit(M.Resize,{width:a.data.width,height:a.data.height});break;case I.FullSnapshot:c=()=>{var u;if(this.firstFullSnapshot){if(this.firstFullSnapshot===a){this.firstFullSnapshot=!0;return}}else this.firstFullSnapshot=!0;this.rebuildFullSnapshot(a,s),(u=this.iframe.contentWindow)==null||u.scrollTo(a.data.initialOffset),this.styleMirror.reset()};break;case I.IncrementalSnapshot:c=()=>{if(this.applyIncremental(a,s),!s&&(a===this.nextUserInteractionEvent&&(this.nextUserInteractionEvent=null,this.backToNormal()),this.config.skipInactive&&!this.nextUserInteractionEvent)){for(const u of this.service.state.context.events)if(!(u.timestamp<=a.timestamp)&&this.isUserInteraction(u)){u.delay-a.delay>Hn*this.speedService.state.context.timer.speed&&(this.nextUserInteractionEvent=u);break}if(this.nextUserInteractionEvent){const u=this.nextUserInteractionEvent.delay-a.delay,d={speed:Math.min(Math.round(u/zn),this.config.maxSpeed)};this.speedService.send({type:"FAST_FORWARD",payload:d}),this.emitter.emit(M.SkipStart,d)}}};break}return()=>{c&&c();for(const d of this.config.plugins||[])d.handler&&d.handler(a,s,{replayer:this});this.service.send({type:"CAST_EVENT",payload:{event:a}});const u=this.service.state.context.events.length-1;if(a===this.service.state.context.events[u]){const d=()=>{u<this.service.state.context.events.length-1||(this.backToNormal(),this.service.send("END"),this.emitter.emit(M.Finish))};a.type===I.IncrementalSnapshot&&a.data.source===D.MouseMove&&a.data.positions.length?setTimeout(()=>{d()},Math.max(0,-a.data.positions[0].timeOffset+50)):d()}this.emitter.emit(M.EventCast,a)}},!(n!=null&&n.liveMode)&&t.length<2)throw new Error("Replayer need at least 2 events.");const r={speed:1,maxSpeed:360,root:document.body,loadTimeout:0,skipInactive:!1,showWarning:!0,showDebug:!1,blockClass:"rr-block",liveMode:!1,insertStyleRules:[],triggerFocus:!0,UNSAFE_replayCanvas:!1,pauseAnimation:!0,mouseTail:Ie,useVirtualDom:!0};this.config=Object.assign({},r,n),this.handleResize=this.handleResize.bind(this),this.getCastFn=this.getCastFn.bind(this),this.applyEventsSynchronously=this.applyEventsSynchronously.bind(this),this.emitter.on(M.Resize,this.handleResize),this.setupDom();for(const a of this.config.plugins||[])a.getMirror&&a.getMirror({nodeMirror:this.mirror});this.emitter.on(M.Flush,()=>{if(this.usingVirtualDom){const a={mirror:this.mirror,applyCanvas:(s,c,u)=>{yt({event:s,mutation:c,target:u,imageMap:this.imageMap,canvasEventMap:this.canvasEventMap,errorHandler:this.warnCanvasMutationFailed.bind(this)})},applyInput:this.applyInput.bind(this),applyScroll:this.applyScroll.bind(this),applyStyleSheetMutation:(s,c)=>{s.source===D.StyleSheetRule?this.applyStyleSheetRule(s,c):s.source===D.StyleDeclaration&&this.applyStyleDeclaration(s,c)}};if(this.iframe.contentDocument&&j(this.iframe.contentDocument,this.virtualDom,a,this.virtualDom.mirror),this.virtualDom.destroyTree(),this.usingVirtualDom=!1,Object.keys(this.legacy_missingNodeRetryMap).length)for(const s in this.legacy_missingNodeRetryMap)try{const c=this.legacy_missingNodeRetryMap[s],u=Se(c.node,this.mirror,this.virtualDom.mirror);j(u,c.node,a,this.virtualDom.mirror),c.node=u}catch(c){this.config.showWarning&&console.warn(c)}this.constructedStyleMutations.forEach(s=>{this.applyStyleSheetMutation(s)}),this.constructedStyleMutations=[],this.adoptedStyleSheets.forEach(s=>{this.applyAdoptedStyleSheet(s)}),this.adoptedStyleSheets=[]}this.mousePos&&(this.moveAndHover(this.mousePos.x,this.mousePos.y,this.mousePos.id,!0,this.mousePos.debugData),this.mousePos=null),this.lastSelectionData&&(this.applySelection(this.lastSelectionData),this.lastSelectionData=null)}),this.emitter.on(M.PlayBack,()=>{this.firstFullSnapshot=null,this.mirror.reset(),this.styleMirror.reset()});const i=new yn([],{speed:this.config.speed,liveMode:this.config.liveMode});this.service=bn({events:t.map(a=>n&&n.unpackFn?n.unpackFn(a):a).sort((a,s)=>a.timestamp-s.timestamp),timer:i,timeOffset:0,baselineTime:0,lastPlayedEvent:null},{getCastFn:this.getCastFn,applyEventsSynchronously:this.applyEventsSynchronously,emitter:this.emitter}),this.service.start(),this.service.subscribe(a=>{this.emitter.emit(M.StateChange,{player:a})}),this.speedService=Dn({normalSpeed:-1,timer:i}),this.speedService.start(),this.speedService.subscribe(a=>{this.emitter.emit(M.StateChange,{speed:a})});const l=this.service.state.context.events.find(a=>a.type===I.Meta),o=this.service.state.context.events.find(a=>a.type===I.FullSnapshot);if(l){const{width:a,height:s}=l.data;setTimeout(()=>{this.emitter.emit(M.Resize,{width:a,height:s})},0)}o&&setTimeout(()=>{var a;this.firstFullSnapshot||(this.firstFullSnapshot=o,this.rebuildFullSnapshot(o),(a=this.iframe.contentWindow)==null||a.scrollTo(o.data.initialOffset))},1),this.service.state.context.events.find(Et)&&this.mouse.classList.add("touch-device")}get timer(){return this.service.state.context.timer}on(t,n){return this.emitter.on(t,n),this}off(t,n){return this.emitter.off(t,n),this}setConfig(t){Object.keys(t).forEach(n=>{t[n],this.config[n]=t[n]}),this.config.skipInactive||this.backToNormal(),typeof t.speed<"u"&&this.speedService.send({type:"SET_SPEED",payload:{speed:t.speed}}),typeof t.mouseTail<"u"&&(t.mouseTail===!1?this.mouseTail&&(this.mouseTail.style.display="none"):(this.mouseTail||(this.mouseTail=document.createElement("canvas"),this.mouseTail.width=Number.parseFloat(this.iframe.width),this.mouseTail.height=Number.parseFloat(this.iframe.height),this.mouseTail.classList.add("replayer-mouse-tail"),this.wrapper.insertBefore(this.mouseTail,this.iframe)),this.mouseTail.style.display="inherit"))}getMetaData(){const t=this.service.state.context.events[0],n=this.service.state.context.events[this.service.state.context.events.length-1];return{startTime:t.timestamp,endTime:n.timestamp,totalTime:n.timestamp-t.timestamp}}getCurrentTime(){return this.timer.timeOffset+this.getTimeOffset()}getTimeOffset(){const{baselineTime:t,events:n}=this.service.state.context;return t-n[0].timestamp}getMirror(){return this.mirror}play(t=0){var n,r;this.service.state.matches("paused")?this.service.send({type:"PLAY",payload:{timeOffset:t}}):(this.service.send({type:"PAUSE"}),this.service.send({type:"PLAY",payload:{timeOffset:t}})),(r=(n=this.iframe.contentDocument)==null?void 0:n.getElementsByTagName("html")[0])==null||r.classList.remove("rrweb-paused"),this.emitter.emit(M.Start)}pause(t){var n,r;t===void 0&&this.service.state.matches("playing")&&this.service.send({type:"PAUSE"}),typeof t=="number"&&(this.play(t),this.service.send({type:"PAUSE"})),(r=(n=this.iframe.contentDocument)==null?void 0:n.getElementsByTagName("html")[0])==null||r.classList.add("rrweb-paused"),this.emitter.emit(M.Pause)}resume(t=0){console.warn("The 'resume' was deprecated in 1.0. Please use 'play' method which has the same interface."),this.play(t),this.emitter.emit(M.Resume)}destroy(){this.pause(),this.config.root.removeChild(this.wrapper),this.emitter.emit(M.Destroy)}startLive(t){this.service.send({type:"TO_LIVE",payload:{baselineTime:t}})}addEvent(t){const n=this.config.unpackFn?this.config.unpackFn(t):t;Et(n)&&this.mouse.classList.add("touch-device"),Promise.resolve().then(()=>this.service.send({type:"ADD_EVENT",payload:{event:n}}))}enableInteract(){this.iframe.setAttribute("scrolling","auto"),this.iframe.style.pointerEvents="auto"}disableInteract(){this.iframe.setAttribute("scrolling","no"),this.iframe.style.pointerEvents="none"}resetCache(){this.cache=We()}setupDom(){this.wrapper=document.createElement("div"),this.wrapper.classList.add("replayer-wrapper"),this.config.root.appendChild(this.wrapper),this.mouse=document.createElement("div"),this.mouse.classList.add("replayer-mouse"),this.wrapper.appendChild(this.mouse),this.config.mouseTail!==!1&&(this.mouseTail=document.createElement("canvas"),this.mouseTail.classList.add("replayer-mouse-tail"),this.mouseTail.style.display="inherit",this.wrapper.appendChild(this.mouseTail)),this.iframe=document.createElement("iframe");const t=["allow-same-origin"];this.config.UNSAFE_replayCanvas&&t.push("allow-scripts"),this.iframe.style.display="none",this.iframe.setAttribute("sandbox",t.join(" ")),this.disableInteract(),this.wrapper.appendChild(this.iframe),this.iframe.contentWindow&&this.iframe.contentDocument&&(gn(this.iframe.contentWindow,this.iframe.contentDocument),Mn(this.iframe.contentWindow))}rebuildFullSnapshot(t,n=!1){if(!this.iframe.contentDocument)return console.warn("Looks like your replayer has been destroyed.");Object.keys(this.legacy_missingNodeRetryMap).length&&console.warn("Found unresolved missing node map",this.legacy_missingNodeRetryMap),this.legacy_missingNodeRetryMap={};const r=[],i=(a,s)=>{this.collectIframeAndAttachDocument(r,a);for(const c of this.config.plugins||[])c.onBuild&&c.onBuild(a,{id:s,replayer:this})};Gt(t.data.node,{doc:this.iframe.contentDocument,afterAppend:i,cache:this.cache,mirror:this.mirror}),i(this.iframe.contentDocument,t.data.node.id);for(const{mutationInQueue:a,builtNode:s}of r)this.attachDocumentToIframe(a,s),this.newDocumentQueue=this.newDocumentQueue.filter(c=>c!==a);const{documentElement:l,head:o}=this.iframe.contentDocument;this.insertStyleRules(l,o),this.service.state.matches("playing")||this.iframe.contentDocument.getElementsByTagName("html")[0].classList.add("rrweb-paused"),this.emitter.emit(M.FullsnapshotRebuilded,t),n||this.waitForStylesheetLoad(),this.config.UNSAFE_replayCanvas&&this.preloadAllImages()}insertStyleRules(t,n){var r;const i=An(this.config.blockClass).concat(this.config.insertStyleRules);if(this.config.pauseAnimation&&i.push("html.rrweb-paused *, html.rrweb-paused *:before, html.rrweb-paused *:after { animation-play-state: paused !important; }"),this.usingVirtualDom){const l=this.virtualDom.createElement("style");this.virtualDom.mirror.add(l,qe(l,this.virtualDom.unserializedId)),t.insertBefore(l,n),l.rules.push({source:D.StyleSheetRule,adds:i.map((o,a)=>({rule:o,index:a}))})}else{const l=document.createElement("style");t.insertBefore(l,n);for(let o=0;o<i.length;o++)(r=l.sheet)==null||r.insertRule(i[o],o)}}attachDocumentToIframe(t,n){const r=this.usingVirtualDom?this.virtualDom.mirror:this.mirror,i=[],l=(o,a)=>{this.collectIframeAndAttachDocument(i,o);const s=r.getMeta(o);if(s?.type===_.Element&&s?.tagName.toUpperCase()==="HTML"){const{documentElement:c,head:u}=n.contentDocument;this.insertStyleRules(c,u)}for(const c of this.config.plugins||[])c.onBuild&&c.onBuild(o,{id:a,replayer:this})};ie(t.node,{doc:n.contentDocument,mirror:r,hackCss:!0,skipChild:!1,afterAppend:l,cache:this.cache}),l(n.contentDocument,t.node.id);for(const{mutationInQueue:o,builtNode:a}of i)this.attachDocumentToIframe(o,a),this.newDocumentQueue=this.newDocumentQueue.filter(s=>s!==o)}collectIframeAndAttachDocument(t,n){if(Ce(n,this.mirror)){const r=this.newDocumentQueue.find(i=>i.parentId===this.mirror.getId(n));r&&t.push({mutationInQueue:r,builtNode:n})}}waitForStylesheetLoad(){var t;const n=(t=this.iframe.contentDocument)==null?void 0:t.head;if(n){const r=new Set;let i,l=this.service.state;const o=()=>{l=this.service.state};this.emitter.on(M.Start,o),this.emitter.on(M.Pause,o);const a=()=>{this.emitter.off(M.Start,o),this.emitter.off(M.Pause,o)};n.querySelectorAll('link[rel="stylesheet"]').forEach(s=>{s.sheet||(r.add(s),s.addEventListener("load",()=>{r.delete(s),r.size===0&&i!==-1&&(l.matches("playing")&&this.play(this.getCurrentTime()),this.emitter.emit(M.LoadStylesheetEnd),i&&clearTimeout(i),a())}))}),r.size>0&&(this.service.send({type:"PAUSE"}),this.emitter.emit(M.LoadStylesheetStart),i=setTimeout(()=>{l.matches("playing")&&this.play(this.getCurrentTime()),i=-1,a()},this.config.loadTimeout))}}preloadAllImages(){return xe(this,null,function*(){this.service.state;const t=()=>{this.service.state};this.emitter.on(M.Start,t),this.emitter.on(M.Pause,t);const n=[];for(const r of this.service.state.context.events)r.type===I.IncrementalSnapshot&&r.data.source===D.CanvasMutation&&(n.push(this.deserializeAndPreloadCanvasEvents(r.data,r)),("commands"in r.data?r.data.commands:[r.data]).forEach(i=>{this.preloadImages(i,r)}));return Promise.all(n)})}preloadImages(t,n){if(t.property==="drawImage"&&typeof t.args[0]=="string"&&!this.imageMap.has(n)){const r=document.createElement("canvas"),i=r.getContext("2d"),l=i?.createImageData(r.width,r.height);l?.data,JSON.parse(t.args[0]),i?.putImageData(l,0,0)}}deserializeAndPreloadCanvasEvents(t,n){return xe(this,null,function*(){if(!this.canvasEventMap.has(n)){const r={isUnchanged:!0};if("commands"in t){const i=yield Promise.all(t.commands.map(l=>xe(this,null,function*(){const o=yield Promise.all(l.args.map(H(this.imageMap,null,r)));return Re(Ne({},l),{args:o})})));r.isUnchanged===!1&&this.canvasEventMap.set(n,Re(Ne({},t),{commands:i}))}else{const i=yield Promise.all(t.args.map(H(this.imageMap,null,r)));r.isUnchanged===!1&&this.canvasEventMap.set(n,Re(Ne({},t),{args:i}))}}})}applyIncremental(t,n){var r,i,l;const{data:o}=t;switch(o.source){case D.Mutation:{try{this.applyMutation(o,n)}catch(a){this.warn(`Exception in mutation ${a.message||a}`,o)}break}case D.Drag:case D.TouchMove:case D.MouseMove:if(n){const a=o.positions[o.positions.length-1];this.mousePos={x:a.x,y:a.y,id:a.id,debugData:o}}else o.positions.forEach(a=>{const s={doAction:()=>{this.moveAndHover(a.x,a.y,a.id,n,o)},delay:a.timeOffset+t.timestamp-this.service.state.context.baselineTime};this.timer.addAction(s)}),this.timer.addAction({doAction(){},delay:t.delay-((r=o.positions[0])==null?void 0:r.timeOffset)});break;case D.MouseInteraction:{if(o.id===-1||n)break;const a=new Event(P[o.type].toLowerCase()),s=this.mirror.getNode(o.id);if(!s)return this.debugNodeNotFound(o,o.id);this.emitter.emit(M.MouseInteraction,{type:o.type,target:s});const{triggerFocus:c}=this.config;switch(o.type){case P.Blur:"blur"in s&&s.blur();break;case P.Focus:c&&s.focus&&s.focus({preventScroll:!0});break;case P.Click:case P.TouchStart:case P.TouchEnd:n?(o.type===P.TouchStart?this.touchActive=!0:o.type===P.TouchEnd&&(this.touchActive=!1),this.mousePos={x:o.x,y:o.y,id:o.id,debugData:o}):(o.type===P.TouchStart&&(this.tailPositions.length=0),this.moveAndHover(o.x,o.y,o.id,n,o),o.type===P.Click?(this.mouse.classList.remove("active"),this.mouse.offsetWidth,this.mouse.classList.add("active")):o.type===P.TouchStart?(this.mouse.offsetWidth,this.mouse.classList.add("touch-active")):o.type===P.TouchEnd&&this.mouse.classList.remove("touch-active"));break;case P.TouchCancel:n?this.touchActive=!1:this.mouse.classList.remove("touch-active");break;default:s.dispatchEvent(a)}break}case D.Scroll:{if(o.id===-1)break;if(this.usingVirtualDom){const a=this.virtualDom.mirror.getNode(o.id);if(!a)return this.debugNodeNotFound(o,o.id);a.scrollData=o;break}this.applyScroll(o,n);break}case D.ViewportResize:this.emitter.emit(M.Resize,{width:o.width,height:o.height});break;case D.Input:{if(o.id===-1)break;if(this.usingVirtualDom){const a=this.virtualDom.mirror.getNode(o.id);if(!a)return this.debugNodeNotFound(o,o.id);a.inputData=o;break}this.applyInput(o);break}case D.MediaInteraction:{const a=this.usingVirtualDom?this.virtualDom.mirror.getNode(o.id):this.mirror.getNode(o.id);if(!a)return this.debugNodeNotFound(o,o.id);const s=a;try{o.currentTime&&(s.currentTime=o.currentTime),o.volume&&(s.volume=o.volume),o.muted&&(s.muted=o.muted),o.type===fe.Pause&&s.pause(),o.type===fe.Play&&s.play(),o.type===fe.RateChange&&(s.playbackRate=o.playbackRate)}catch(c){this.config.showWarning&&console.warn(`Failed to replay media interactions: ${c.message||c}`)}break}case D.StyleSheetRule:case D.StyleDeclaration:{this.usingVirtualDom?o.styleId?this.constructedStyleMutations.push(o):o.id&&((i=this.virtualDom.mirror.getNode(o.id))==null||i.rules.push(o)):this.applyStyleSheetMutation(o);break}case D.CanvasMutation:{if(!this.config.UNSAFE_replayCanvas)return;if(this.usingVirtualDom){const a=this.virtualDom.mirror.getNode(o.id);if(!a)return this.debugNodeNotFound(o,o.id);a.canvasMutations.push({event:t,mutation:o})}else{const a=this.mirror.getNode(o.id);if(!a)return this.debugNodeNotFound(o,o.id);yt({event:t,mutation:o,target:a,imageMap:this.imageMap,canvasEventMap:this.canvasEventMap,errorHandler:this.warnCanvasMutationFailed.bind(this)})}break}case D.Font:{try{const a=new FontFace(o.family,o.buffer?new Uint8Array(JSON.parse(o.fontSource)):o.fontSource,o.descriptors);(l=this.iframe.contentDocument)==null||l.fonts.add(a)}catch(a){this.config.showWarning&&console.warn(a)}break}case D.Selection:{if(n){this.lastSelectionData=o;break}this.applySelection(o);break}case D.AdoptedStyleSheet:{this.usingVirtualDom?this.adoptedStyleSheets.push(o):this.applyAdoptedStyleSheet(o);break}}}applyMutation(t,n){if(this.config.useVirtualDom&&!this.usingVirtualDom&&n&&(this.usingVirtualDom=!0,hn(this.iframe.contentDocument,this.mirror,this.virtualDom),Object.keys(this.legacy_missingNodeRetryMap).length))for(const c in this.legacy_missingNodeRetryMap)try{const u=this.legacy_missingNodeRetryMap[c],d=Qe(u.node,this.virtualDom,this.mirror);d&&(u.node=d)}catch(u){this.config.showWarning&&console.warn(u)}const r=this.usingVirtualDom?this.virtualDom.mirror:this.mirror;t.removes.forEach(c=>{var u;const d=r.getNode(c.id);if(!d)return t.removes.find(f=>f.id===c.parentId)?void 0:this.warnNodeNotFound(t,c.id);let m=r.getNode(c.parentId);if(!m)return this.warnNodeNotFound(t,c.parentId);if(c.isShadow&&ye(m)&&(m=m.shadowRoot),r.removeNodeFromMap(d),m)try{m.removeChild(d),this.usingVirtualDom&&d.nodeName==="#text"&&m.nodeName==="STYLE"&&((u=m.rules)==null?void 0:u.length)>0&&(m.rules=[])}catch(f){if(f instanceof DOMException)this.warn("parent could not remove child in mutation",m,d,t);else throw f}});const i=Ne({},this.legacy_missingNodeRetryMap),l=[],o=c=>{let u=null;return c.nextId&&(u=r.getNode(c.nextId)),c.nextId!==null&&c.nextId!==void 0&&c.nextId!==-1&&!u},a=c=>{var u;if(!this.iframe.contentDocument)return console.warn("Looks like your replayer has been destroyed.");let d=r.getNode(c.parentId);if(!d)return c.node.type===_.Document?this.newDocumentQueue.push(c):l.push(c);c.node.isShadow&&(ye(d)||d.attachShadow({mode:"open"}),d=d.shadowRoot);let m=null,f=null;if(c.previousId&&(m=r.getNode(c.previousId)),c.nextId&&(f=r.getNode(c.nextId)),o(c))return l.push(c);if(c.node.rootId&&!r.getNode(c.node.rootId))return;const N=c.node.rootId?r.getNode(c.node.rootId):this.usingVirtualDom?this.virtualDom:this.iframe.contentDocument;if(Ce(d,r)){this.attachDocumentToIframe(c,d);return}const E=(v,w)=>{for(const T of this.config.plugins||[])T.onBuild&&T.onBuild(v,{id:w,replayer:this})},y=ie(c.node,{doc:N,mirror:r,skipChild:!0,hackCss:!0,cache:this.cache,afterAppend:E});if(c.previousId===-1||c.nextId===-1){i[c.node.id]={node:y,mutation:c};return}const p=r.getMeta(d);if(p&&p.type===_.Element&&p.tagName==="textarea"&&c.node.type===_.Text){const v=Array.isArray(d.childNodes)?d.childNodes:Array.from(d.childNodes);for(const w of v)w.nodeType===d.TEXT_NODE&&d.removeChild(w)}if(m&&m.nextSibling&&m.nextSibling.parentNode)d.insertBefore(y,m.nextSibling);else if(f&&f.parentNode)d.contains(f)?d.insertBefore(y,f):d.insertBefore(y,null);else{if(d===N)for(;N.firstChild;)N.removeChild(N.firstChild);d.appendChild(y)}if(E(y,c.node.id),this.usingVirtualDom&&y.nodeName==="#text"&&d.nodeName==="STYLE"&&((u=d.rules)==null?void 0:u.length)>0&&(d.rules=[]),Ce(y,this.mirror)){const v=this.mirror.getId(y),w=this.newDocumentQueue.find(T=>T.parentId===v);w&&(this.attachDocumentToIframe(w,y),this.newDocumentQueue=this.newDocumentQueue.filter(T=>T!==w))}(c.previousId||c.nextId)&&this.legacy_resolveMissingNode(i,d,y,c)};t.adds.forEach(c=>{a(c)});const s=Date.now();for(;l.length;){const c=Cn(l);if(l.length=0,Date.now()-s>500){this.warn("Timeout in the loop, please check the resolve tree data:",c);break}for(const u of c)r.getNode(u.value.parentId)?dt(u,d=>{a(d)}):this.debug("Drop resolve tree since there is no parent for the root node.",u)}Object.keys(i).length&&Object.assign(this.legacy_missingNodeRetryMap,i),Rn(t.texts).forEach(c=>{var u;const d=r.getNode(c.id);if(!d)return t.removes.find(m=>m.id===c.id)?void 0:this.warnNodeNotFound(t,c.id);if(d.textContent=c.value,this.usingVirtualDom){const m=d.parentNode;((u=m?.rules)==null?void 0:u.length)>0&&(m.rules=[])}}),t.attributes.forEach(c=>{const u=r.getNode(c.id);if(!u)return t.removes.find(d=>d.id===c.id)?void 0:this.warnNodeNotFound(t,c.id);for(const d in c.attributes)if(typeof d=="string"){const m=c.attributes[d];if(m===null)u.removeAttribute(d);else if(typeof m=="string")try{if(d==="_cssText"&&(u.nodeName==="LINK"||u.nodeName==="STYLE"))try{const f=r.getMeta(u);Object.assign(f.attributes,c.attributes);const N=ie(f,{doc:u.ownerDocument,mirror:r,skipChild:!0,hackCss:!0,cache:this.cache}),E=u.nextSibling,y=u.parentNode;if(N&&y){y.removeChild(u),y.insertBefore(N,E),r.replace(c.id,N);break}}catch{}u.setAttribute(d,m)}catch(f){this.config.showWarning&&console.warn("An error occurred may due to the checkout feature.",f)}else if(d==="style"){const f=m,N=u;for(const E in f)if(f[E]===!1)N.style.removeProperty(E);else if(f[E]instanceof Array){const y=f[E];N.style.setProperty(E,y[0],y[1])}else{const y=f[E];N.style.setProperty(E,y)}}}})}applyScroll(t,n){var r,i;const l=this.mirror.getNode(t.id);if(!l)return this.debugNodeNotFound(t,t.id);const o=this.mirror.getMeta(l);if(l===this.iframe.contentDocument)(r=this.iframe.contentWindow)==null||r.scrollTo({top:t.y,left:t.x,behavior:n?"auto":"smooth"});else if(o?.type===_.Document)(i=l.defaultView)==null||i.scrollTo({top:t.y,left:t.x,behavior:n?"auto":"smooth"});else try{l.scrollTo({top:t.y,left:t.x,behavior:n?"auto":"smooth"})}catch{}}applyInput(t){const n=this.mirror.getNode(t.id);if(!n)return this.debugNodeNotFound(t,t.id);try{n.checked=t.isChecked,n.value=t.text}catch{}}applySelection(t){try{const n=new Set,r=t.ranges.map(({start:i,startOffset:l,end:o,endOffset:a})=>{const s=this.mirror.getNode(i),c=this.mirror.getNode(o);if(!s||!c)return;const u=new Range;u.setStart(s,l),u.setEnd(c,a);const d=s.ownerDocument,m=d?.getSelection();return m&&n.add(m),{range:u,selection:m}});n.forEach(i=>i.removeAllRanges()),r.forEach(i=>{var l;return i&&((l=i.selection)==null?void 0:l.addRange(i.range))})}catch{}}applyStyleSheetMutation(t){var n;let r=null;t.styleId?r=this.styleMirror.getStyle(t.styleId):t.id&&(r=((n=this.mirror.getNode(t.id))==null?void 0:n.sheet)||null),r&&(t.source===D.StyleSheetRule?this.applyStyleSheetRule(t,r):t.source===D.StyleDeclaration&&this.applyStyleDeclaration(t,r))}applyStyleSheetRule(t,n){var r,i,l,o;if((r=t.adds)==null||r.forEach(({rule:a,index:s})=>{try{if(Array.isArray(s)){const{positions:c,index:u}=pt(s);ae(n.cssRules,c).insertRule(a,u)}else{const c=s===void 0?void 0:Math.min(s,n.cssRules.length);n?.insertRule(a,c)}}catch{}}),(i=t.removes)==null||i.forEach(({index:a})=>{try{if(Array.isArray(a)){const{positions:s,index:c}=pt(a);ae(n.cssRules,s).deleteRule(c||0)}else n?.deleteRule(a)}catch{}}),t.replace)try{(l=n.replace)==null||l.call(n,t.replace)}catch{}if(t.replaceSync)try{(o=n.replaceSync)==null||o.call(n,t.replaceSync)}catch{}}applyStyleDeclaration(t,n){t.set&&ae(n.rules,t.index).style.setProperty(t.set.property,t.set.value,t.set.priority),t.remove&&ae(n.rules,t.index).style.removeProperty(t.remove.property)}applyAdoptedStyleSheet(t){var n;const r=this.mirror.getNode(t.id);if(!r)return;(n=t.styles)==null||n.forEach(a=>{var s;let c=null,u=null;if(ye(r)?u=((s=r.ownerDocument)==null?void 0:s.defaultView)||null:r.nodeName==="#document"&&(u=r.defaultView),!!u)try{c=new u.CSSStyleSheet,this.styleMirror.add(c,a.styleId),this.applyStyleSheetRule({source:D.StyleSheetRule,adds:a.rules},c)}catch{}});const i=10;let l=0;const o=(a,s)=>{const c=s.map(u=>this.styleMirror.getStyle(u)).filter(u=>u!==null);ye(a)?a.shadowRoot.adoptedStyleSheets=c:a.nodeName==="#document"&&(a.adoptedStyleSheets=c),c.length!==s.length&&l<i&&(setTimeout(()=>o(a,s),0+100*l),l++)};o(r,t.styleIds)}legacy_resolveMissingNode(t,n,r,i){const{previousId:l,nextId:o}=i,a=l&&t[l],s=o&&t[o];if(a){const{node:c,mutation:u}=a;n.insertBefore(c,r),delete t[u.node.id],delete this.legacy_missingNodeRetryMap[u.node.id],(u.previousId||u.nextId)&&this.legacy_resolveMissingNode(t,n,c,u)}if(s){const{node:c,mutation:u}=s;n.insertBefore(c,r.nextSibling),delete t[u.node.id],delete this.legacy_missingNodeRetryMap[u.node.id],(u.previousId||u.nextId)&&this.legacy_resolveMissingNode(t,n,c,u)}}moveAndHover(t,n,r,i,l){const o=this.mirror.getNode(r);if(!o)return this.debugNodeNotFound(l,r);const a=ht(o,this.iframe),s=t*a.absoluteScale+a.x,c=n*a.absoluteScale+a.y;this.mouse.style.left=`${s}px`,this.mouse.style.top=`${c}px`,i||this.drawMouseTail({x:s,y:c}),this.hoverElements(o)}drawMouseTail(t){if(!this.mouseTail)return;const{lineCap:n,lineWidth:r,strokeStyle:i,duration:l}=this.config.mouseTail===!0?Ie:Object.assign({},Ie,this.config.mouseTail),o=()=>{if(!this.mouseTail)return;const a=this.mouseTail.getContext("2d");!a||!this.tailPositions.length||(a.clearRect(0,0,this.mouseTail.width,this.mouseTail.height),a.beginPath(),a.lineWidth=r,a.lineCap=n,a.strokeStyle=i,a.moveTo(this.tailPositions[0].x,this.tailPositions[0].y),this.tailPositions.forEach(s=>a.lineTo(s.x,s.y)),a.stroke())};this.tailPositions.push(t),o(),setTimeout(()=>{this.tailPositions=this.tailPositions.filter(a=>a!==t),o()},l/this.speedService.state.context.timer.speed)}hoverElements(t){var n;(n=this.iframe.contentDocument)==null||n.querySelectorAll(".\\:hover").forEach(i=>{i.classList.remove(":hover")});let r=t;for(;r;)r.classList&&r.classList.add(":hover"),r=r.parentElement}isUserInteraction(t){return t.type!==I.IncrementalSnapshot?!1:t.data.source>D.Mutation&&t.data.source<=D.Input}backToNormal(){this.nextUserInteractionEvent=null,!this.speedService.state.matches("normal")&&(this.speedService.send({type:"BACK_TO_NORMAL"}),this.emitter.emit(M.SkipEnd,{speed:this.speedService.state.context.normalSpeed}))}warnNodeNotFound(t,n){this.warn(`Node with id '${n}' not found. `,t)}warnCanvasMutationFailed(t,n){this.warn("Has error on canvas update",n,"canvas mutation:",t)}debugNodeNotFound(t,n){this.debug(Ae,`Node with id '${n}' not found. `,t)}warn(...t){!this.config.showWarning||console.warn(Ae,...t)}debug(...t){!this.config.showDebug||console.log(Ae,...t)}}var U=Uint8Array,z=Uint16Array,Oe=Uint32Array,wt=new U([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Tt=new U([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),qn=new U([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),St=function(e,t){for(var n=new z(31),r=0;r<31;++r)n[r]=t+=1<<e[r-1];for(var i=new Oe(n[30]),r=1;r<30;++r)for(var l=n[r];l<n[r+1];++l)i[l]=l-n[r]<<5|r;return[n,i]},bt=St(wt,2),Dt=bt[0],Jn=bt[1];Dt[28]=258,Jn[258]=28;for(var Zn=St(Tt,0),Kn=Zn[0],ke=new z(32768),R=0;R<32768;++R){var X=(R&43690)>>>1|(R&21845)<<1;X=(X&52428)>>>2|(X&13107)<<2,X=(X&61680)>>>4|(X&3855)<<4,ke[R]=((X&65280)>>>8|(X&255)<<8)>>>1}for(var ce=function(e,t,n){for(var r=e.length,i=0,l=new z(t);i<r;++i)++l[e[i]-1];var o=new z(t);for(i=0;i<t;++i)o[i]=o[i-1]+l[i-1]<<1;var a;if(n){a=new z(1<<t);var s=15-t;for(i=0;i<r;++i)if(e[i])for(var c=i<<4|e[i],u=t-e[i],d=o[e[i]-1]++<<u,m=d|(1<<u)-1;d<=m;++d)a[ke[d]>>>s]=c}else for(a=new z(r),i=0;i<r;++i)a[i]=ke[o[e[i]-1]++]>>>15-e[i];return a},ue=new U(288),R=0;R<144;++R)ue[R]=8;for(var R=144;R<256;++R)ue[R]=9;for(var R=256;R<280;++R)ue[R]=7;for(var R=280;R<288;++R)ue[R]=8;for(var Mt=new U(32),R=0;R<32;++R)Mt[R]=5;var er=ce(ue,9,1),tr=ce(Mt,5,1),_e=function(e){for(var t=e[0],n=1;n<e.length;++n)e[n]>t&&(t=e[n]);return t},V=function(e,t,n){var r=t/8>>0;return(e[r]|e[r+1]<<8)>>>(t&7)&n},Le=function(e,t){var n=t/8>>0;return(e[n]|e[n+1]<<8|e[n+2]<<16)>>>(t&7)},nr=function(e){return(e/8>>0)+(e&7&&1)},Ct=function(e,t,n){(t==null||t<0)&&(t=0),(n==null||n>e.length)&&(n=e.length);var r=new(e instanceof z?z:e instanceof Oe?Oe:U)(n-t);return r.set(e.subarray(t,n)),r},rr=function(e,t,n){var r=e.length,i=!t||n,l=!n||n.i;n||(n={}),t||(t=new U(r*3));var o=function(At){var It=t.length;if(At>It){var Ot=new U(Math.max(It*2,At));Ot.set(t),t=Ot}},a=n.f||0,s=n.p||0,c=n.b||0,u=n.l,d=n.d,m=n.m,f=n.n,N=r*8;do{if(!u){n.f=a=V(e,s,1);var E=V(e,s+1,3);if(s+=3,E)if(E==1)u=er,d=tr,m=9,f=5;else if(E==2){var w=V(e,s,31)+257,T=V(e,s+10,15)+4,x=w+V(e,s+5,31)+1;s+=14;for(var A=new U(x),$=new U(19),L=0;L<T;++L)$[qn[L]]=V(e,s+L*3,7);s+=T*3;var Z=_e($),de=(1<<Z)-1;if(!l&&s+x*(Z+7)>N)break;for(var he=ce($,Z,1),L=0;L<x;){var Q=he[V(e,s,de)];s+=Q&15;var y=Q>>>4;if(y<16)A[L++]=y;else{var G=0,q=0;for(y==16?(q=3+V(e,s,3),s+=2,G=A[L-1]):y==17?(q=3+V(e,s,7),s+=3):y==18&&(q=11+V(e,s,127),s+=7);q--;)A[L++]=G}}var oe=A.subarray(0,w),B=A.subarray(w);m=_e(oe),f=_e(B),u=ce(oe,m,1),d=ce(B,f,1)}else throw"invalid block type";else{var y=nr(s)+4,p=e[y-4]|e[y-3]<<8,v=y+p;if(v>r){if(l)throw"unexpected EOF";break}i&&o(c+p),t.set(e.subarray(y,v),c),n.b=c+=p,n.p=s=v*8;continue}if(s>N)throw"unexpected EOF"}i&&o(c+131072);for(var k=(1<<m)-1,K=(1<<f)-1,g=m+f+18;l||s+g<N;){var G=u[Le(e,s)&k],h=G>>>4;if(s+=G&15,s>N)throw"unexpected EOF";if(!G)throw"invalid length/literal";if(h<256)t[c++]=h;else if(h==256){u=null;break}else{var b=h-254;if(h>264){var L=h-257,C=wt[L];b=V(e,s,(1<<C)-1)+Dt[L],s+=C}var F=d[Le(e,s)&K],J=F>>>4;if(!F)throw"invalid distance";s+=F&15;var B=Kn[J];if(J>3){var C=Tt[J];B+=Le(e,s)&(1<<C)-1,s+=C}if(s>N)throw"unexpected EOF";i&&o(c+131072);for(var xt=c+b;c<xt;c+=4)t[c]=t[c-B],t[c+1]=t[c+1-B],t[c+2]=t[c+2-B],t[c+3]=t[c+3-B];c=xt}}n.l=u,n.p=s,n.b=c,u&&(a=1,n.m=m,n.d=d,n.n=f)}while(!a);return c==t.length?t:Ct(t,0,c)},or=function(e){if((e[0]&15)!=8||e[0]>>>4>7||(e[0]<<8|e[1])%31)throw"invalid zlib data";if(e[1]&32)throw"invalid zlib data: preset dictionaries not supported"};function ir(e,t){return rr((or(e),e.subarray(2,-4)),t)}function sr(e,t){var n=e.length;if(!t&&typeof TextEncoder<"u")return new TextEncoder().encode(e);for(var r=new U(e.length+(e.length>>>1)),i=0,l=function(c){r[i++]=c},o=0;o<n;++o){if(i+5>r.length){var a=new U(i+8+(n-o<<1));a.set(r),r=a}var s=e.charCodeAt(o);s<128||t?l(s):s<2048?(l(192|s>>>6),l(128|s&63)):s>55295&&s<57344?(s=65536+(s&1047552)|e.charCodeAt(++o)&1023,l(240|s>>>18),l(128|s>>>12&63),l(128|s>>>6&63),l(128|s&63)):(l(224|s>>>12),l(128|s>>>6&63),l(128|s&63))}return Ct(r,0,i)}function ar(e,t){var n="";if(!t&&typeof TextDecoder<"u")return new TextDecoder().decode(e);for(var r=0;r<e.length;){var i=e[r++];i<128||t?n+=String.fromCharCode(i):i<224?n+=String.fromCharCode((i&31)<<6|e[r++]&63):i<240?n+=String.fromCharCode((i&15)<<12|(e[r++]&63)<<6|e[r++]&63):(i=((i&15)<<18|(e[r++]&63)<<12|(e[r++]&63)<<6|e[r++]&63)-65536,n+=String.fromCharCode(55296|i>>10,56320|i&1023))}return n}const Rt="v1",lr=e=>{if(typeof e!="string")return e;try{const t=JSON.parse(e);if(t.timestamp)return t}catch{}try{const t=JSON.parse(ar(ir(sr(e,!0))));if(t.v===Rt)return t;throw new Error(`These events were packed with packer ${t.v} which is incompatible with current packer ${Rt}.`)}catch(t){throw console.error(t),new Error("Unknown data format.")}};return pe.Replayer=Qn,pe.unpack=lr,Object.defineProperty(pe,"__esModule",{value:!0}),pe}({});
//# sourceMappingURL=rrweb-replay-unpack.min.js.map
